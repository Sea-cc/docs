<template><div><h1 id="ğŸ“–-åŸºäº-typescript-äºŒæ¬¡å°è£…-axios" tabindex="-1"><a class="header-anchor" href="#ğŸ“–-åŸºäº-typescript-äºŒæ¬¡å°è£…-axios" aria-hidden="true">#</a> ğŸ“– åŸºäº typescript äºŒæ¬¡å°è£… axios</h1>
<blockquote>
<p>å¯¹ axios äºŒæ¬¡å°è£…,æ›´åŠ çš„å¯é…ç½®åŒ–ã€æ‰©å±•æ€§æ›´åŠ å¼ºå¤§çµæ´»</p>
<p>é€šè¿‡ class ç±»å®ç°ï¼Œclass å…·å¤‡æ›´å¼ºå°è£…æ€§(<code v-pre>å°è£…ã€ç»§æ‰¿ã€å¤šæ€</code>)ï¼Œé€šè¿‡å®ä¾‹åŒ–ç±»ä¼ å…¥è‡ªå®šä¹‰çš„é…ç½®</p>
</blockquote>
<h3 id="åˆ›å»º-class" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-class" aria-hidden="true">#</a> åˆ›å»º class</h3>
<p>ä¸¥æ ¼è¦æ±‚å®ä¾‹åŒ–æ—¶ä¼ å…¥çš„é…ç½®ï¼Œæ‹¥æœ‰æ›´å¥½çš„ä»£ç æç¤º</p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{AxiosInstance}</span><span style="color: var(--shiki-token-comment)"> axioså®ä¾‹ç±»å‹</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{AxiosRequestConfig}</span><span style="color: var(--shiki-token-comment)"> axiosé…ç½®é¡¹ç±»å‹</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">import</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">type</span><span style="color: var(--shiki-color-text)"> { AxiosInstance</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AxiosRequestConfig } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;axios&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    axios</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosInstance</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">(config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// åˆ›å»ºä¸€ä¸ªå®ä¾‹ axios.create([config])</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.axios </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.create</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// æ¯å®ä¾‹åŒ–ä¸€ä¸ª axios æ—¶ï¼Œéƒ½æ˜¯ä¸åŒçš„ axios ç¤ºä¾‹ï¼Œäº’ä¸å¹²æ‰°</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    baseURL</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-token-string-expression)">&#39;qq.com&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    timeout:</span><span style="color: var(--shiki-token-constant)">60</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    baseURL</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-token-string-expression)">&#39;web.com&#39;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<h5 id="axios-create-config" tabindex="-1"><a class="header-anchor" href="#axios-create-config" aria-hidden="true">#</a> axios.create([config])</h5>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">instance</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.create</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  baseURL</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;https://some-domain.com/api/&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  timeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  headers</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> {</span><span style="color: var(--shiki-token-string-expression)">&#39;X-Custom-Header&#39;</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;foobar&#39;</span><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote>
<p><strong>AxiosRequestConfig çš„ç±»å‹æ³¨è§£</strong></p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">D</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">&gt; {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  url</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  method</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Method</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  baseURL</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  transformRequest</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestTransformer</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestTransformer</span><span style="color: var(--shiki-color-text)">[];</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  transformResponse</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponseTransformer</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponseTransformer</span><span style="color: var(--shiki-color-text)">[];</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  headers</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestHeaders</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  params</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">paramsSerializer</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> (params</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  data</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">D</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  timeout</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  timeoutErrorMessage</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  withCredentials</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">boolean</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  adapter</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosAdapter</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  auth</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosBasicCredentials</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  responseType</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">ResponseType</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  responseEncoding</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">responseEncoding</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  xsrfCookieName</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  xsrfHeaderName</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">onUploadProgress</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> (progressEvent</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">void</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">onDownloadProgress</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> (progressEvent</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">void</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  maxContentLength</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  validateStatus</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> ((status</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">boolean</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  maxBodyLength</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  maxRedirects</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">beforeRedirect</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> (options</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Record</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">&gt;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> responseDetails</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> {headers</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Record</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">&gt;}) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">void</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  socketPath</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">null</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  httpAgent</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  httpsAgent</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  proxy</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosProxyConfig</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">|</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">false</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  cancelToken</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">CancelToken</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  decompress</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">boolean</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  transitional</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">TransitionalOptions</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  signal</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AbortSignal</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  insecureHTTPParser</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">boolean</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  env</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    FormData</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">args</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">[]) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">object</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  };</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…-request-config-é€šç”¨æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#å°è£…-request-config-é€šç”¨æ–¹æ³•" aria-hidden="true">#</a> å°è£… request(config)é€šç”¨æ–¹æ³•</h3>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* axios#request(config)</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{*}</span><span style="color: var(--shiki-token-comment)"> config</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* </span><span style="color: var(--shiki-token-keyword)">@returns</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{*}</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">*/</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">request</span><span style="color: var(--shiki-color-text)">(config: AxiosRequestConfig) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>ğŸ¹ <strong>åœ¨ axios ä¸­ï¼Œrequestä¸­çš„ config å‚æ•°ä¸å®ä¾‹åŒ–æ—¶ï¼Œ<code v-pre>axios.create(config)</code>ä¼ å…¥çš„å‚æ•°æ˜¯ç›¸åŒçš„</strong>ï¼Œä»¥ä¸‹æ˜¯ axios æ–¹æ³•å…·ä½“å‚æ•°</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.get</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.delete</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.head</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.options</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.post</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> data[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config]])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.put</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> data[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config]])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.patch</span><span style="color: var(--shiki-color-text)">(url[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> data[</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> config]])</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.getUri</span><span style="color: var(--shiki-color-text)">([config])</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote>
<h3 id="å°è£…-æ‹¦æˆªå™¨-å•ä¸ªå®ä¾‹ç‹¬äº«" tabindex="-1"><a class="header-anchor" href="#å°è£…-æ‹¦æˆªå™¨-å•ä¸ªå®ä¾‹ç‹¬äº«" aria-hidden="true">#</a> å°è£…-æ‹¦æˆªå™¨(å•ä¸ªå®ä¾‹ç‹¬äº«)</h3>
<p><strong>æ‹¦æˆªå™¨çš„hooks,åœ¨è¯·æ±‚æˆ–å“åº”è¢« then æˆ– catch å¤„ç†å‰æ‹¦æˆªå¤„ç†</strong></p>
<blockquote>
<p>ğŸ›¹åœ¨è¯·æ±‚ä¸­ï¼Œå¦‚<code v-pre>æºå¸¦tokenã€loadingåŠ¨ç”»ã€headeré…ç½®...</code>ï¼Œéƒ½æ˜¯ä¸€äº›å…¬æœ‰çš„é€»è¾‘ï¼Œæ‰€ä»¥å¯ä»¥å†™åˆ°å…¨å±€çš„æ‹¦æˆªå™¨é‡Œé¢</p>
<p>ğŸ›µæ³¨æ„çš„æ˜¯ï¼Œå¯èƒ½å­˜åœ¨æŸäº›é¡¹ç›®è¯·æ±‚ï¼Œéœ€è¦çš„å…¬æœ‰çš„é€»è¾‘é…ç½®æ–¹å¼ä¸ä¸€æ ·ï¼Œå¦‚ Aé¡¹ç›®ï¼š<code v-pre>æºå¸¦tokenã€loadingåŠ¨ç”»</code>,Bé¡¹ç›®ï¼š<code v-pre>æºå¸¦tokenã€headeré…ç½®</code></p>
<p>ğŸª‚è€ƒè™‘åˆ°æ‹¦æˆªæ–¹å¼ä¸ä¸€æ ·ï¼Œå›ºä¸èƒ½å°† class é‡Œçš„æ‹¦æˆªå™¨å†™siï¼Œæ‰€ä»¥ï¼Œéœ€è¦é€šè¿‡ä¸åŒçš„ axios å®ä¾‹åŒ–ä¼ å…¥è‡ªå®šä¹‰çš„ <code v-pre>hooks(æ‹¦æˆªå™¨)</code>ï¼Œ<strong>å®ç°å•ä¸ªå®ä¾‹ç‹¬äº«</strong>ï¼Œæ‰©å±•æ€§æ›´å¼º</p>
</blockquote>
<p>åœ¨ä¸Šé¢<code v-pre>å®ä¾‹åŒ– Http(Axios) æ—¶</code>ï¼Œä»…ä»…ä¼ å…¥ axios çº¦å®šå¥½çš„ <code v-pre>config(AxiosRequestConfig)</code></p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    baseURL</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-token-string-expression)">&#39;qq.com&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    timeout:</span><span style="color: var(--shiki-token-constant)">60</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»è¿‡åˆ†æè€ƒè™‘ï¼Œéœ€è¦åœ¨å®ä¾‹åŒ– Http æ—¶ï¼Œå¯ä»¥ä¼ å…¥æ›´å¤šè‡ªå®šä¹‰çš„ hooksï¼Œæ‰©å±• axiosã€‚ä½†æ˜¯ï¼Œ<strong>åœ¨å®ä¾‹åŒ–æ—¶ï¼Œç›´æ¥ä¼ å…¥å®šä¹‰å¥½çš„æ‹¦æˆªå™¨æ˜¯ä¸å¯è¡Œçš„ <code v-pre>Why?</code></strong></p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    baseURL</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;qq.com&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    timeout</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">60</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">*</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    hooks</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> {}</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-comment)">// ERROR âŒâŒâ­•â­•</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">interceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {} </span><span style="color: var(--shiki-token-comment)">// ERROR â­•â­•âŒâŒ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p><code v-pre>â€œhooksâ€ä¸åœ¨ç±»å‹â€œAxiosRequestConfig&lt;any&gt;â€ä¸­</code>ï¼Œåœ¨ä¸Šé¢ Http class çš„ constructor æ„é€ å‡½æ•°ä¸­ï¼Œä¸¥æ ¼çº¦æŸä¼ å…¥çš„å‚æ•°åº”ä¸º<code v-pre>AxiosRequestConfig</code>ç±»å‹(TS)</p>
<p>AxiosRequestConfig ä¸­å¹¶ä¸å­˜åœ¨ <code v-pre>hooks and interceptor</code>ç±»å‹çš„å±æ€§(AxiosRequestConfig æ˜¯ç”± axios æä¾›çš„ä¸€ä¸ªç±»å‹æ³¨è§£)</p>
</blockquote>
<h4 id="ğŸš€æ‰©å±•-http-è‡ªå®šä¹‰æ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#ğŸš€æ‰©å±•-http-è‡ªå®šä¹‰æ‹¦æˆªå™¨" aria-hidden="true">#</a> <strong>ğŸš€æ‰©å±• Http è‡ªå®šä¹‰æ‹¦æˆªå™¨</strong></h4>
<p>å¯¹ <code v-pre>AxiosRequestConfig</code> ç±»å‹æ³¨è§£<strong>è¿›è¡Œç»§æ‰¿</strong>ï¼Œä½¿å¾—åœ¨å®ä¾‹åŒ–æ—¶ï¼Œå¯ä»¥ä¼ å…¥æ‰©å±•åçš„ç±»å‹ï¼Œå®šä¹‰ï¼š</p>
<p>ğŸœï¸<code v-pre>IinterceptorHooks</code>æ¥å£å­˜å‚¨è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨å‡½æ•°ã€</p>
<p>ğŸ™ï¸<code v-pre>IHttpRequestConfig</code>æ¥å£ç»§æ‰¿ AxiosRequestConfigï¼Œå¹¶æ‰©å±•è‡ªå®šä¹‰æ‹¦æˆªå™¨çš„å±æ€§ï¼Œå±æ€§ç±»å‹ä¸ºï¼šIinterceptorHooks</p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-color-text)">ğŸœï¸</span><span style="color: var(--shiki-token-string-expression)">`IinterceptorHooks`</span><span style="color: var(--shiki-color-text)">æ‹¦æˆªå™¨Hookæ¥å£ç±»å‹</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">import</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">type</span><span style="color: var(--shiki-color-text)"> { AxiosResponse</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> AxiosRequestConfig } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;axios&#39;</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * æ‹¦æˆªå™¨çš„hooks,åœ¨è¯·æ±‚æˆ–å“åº”è¢« then æˆ– catch å¤„ç†å‰æ‹¦æˆª</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{beforeRequestInterceptor(?)}</span><span style="color: var(--shiki-token-comment)"> å‘é€è¯·æ±‚ä¹‹å‰æ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{requestErrorInterceptor(?)}</span><span style="color: var(--shiki-token-comment)"> è¯·æ±‚é”™è¯¯æ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{responseSuccessInterceptor(?)}</span><span style="color: var(--shiki-token-comment)"> å“åº”æˆåŠŸæ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{responseFailInterceptor(?)}</span><span style="color: var(--shiki-token-comment)"> å“åº”å¤±è´¥æ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">interceptorHooks</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">beforeRequestInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">requestErrorInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (error</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">responseSuccessInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (result</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponse</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponse</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">responseFailInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (error</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">type</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IinterceptorHooks</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Partial</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">interceptorHooks</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>ğŸŒ<strong>Partial</strong>:Typescript å†…ç½®ç±»å‹ï¼Œ<strong>å°†å®šä¹‰çš„ç±»å‹æ³¨è§£å…¨éƒ¨å˜ä¸ºå¯é€‰çš„å±æ€§</strong></p>
<p>ğŸª‚<strong>è°ƒç”¨è¯´æ˜</strong>ï¼š<code v-pre> axios.interceptors.request.use( beforeRequestInterceptor , requestErrorInterceptor );</code></p>
</blockquote>
<blockquote>
<p>è¯·æ±‚ä¹‹å‰æ‹¦æˆªå™¨ä¸­(beforeRequestInterceptor)ï¼Œconfig å‚æ•°åŒæ ·æ˜¯ä¸<code v-pre>axios.create</code>ä¸­çš„å‚æ•°ç±»å‹ç›¸åŒï¼Œä¸º<code v-pre>AxiosRequestConfig</code></p>
<p>æ³¨æ„ï¼šå¹¶ä¸æ˜¯<code v-pre>IHttpRequestConfig</code></p>
</blockquote>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-color-text)">ğŸ™ï¸</span><span style="color: var(--shiki-token-string-expression)">`IHttpRequestConfig`</span><span style="color: var(--shiki-color-text)"> ç±»æ„é€ å‡½æ•° config æ¥å£ç±»å‹</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * å®ä¾‹åŒ–Httpç±»çš„é…ç½®é¡¹å‚æ•°,ç»§æ‰¿äºAxiosRequestConfig</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{interceptors(?)}</span><span style="color: var(--shiki-token-comment)"> æ‹¦æˆªå™¨Hooks</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{loading}</span><span style="color: var(--shiki-token-comment)"> è¯·æ±‚loading</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{...}</span><span style="color: var(--shiki-token-comment)"> å…¶å®ƒçš„é…ç½®é¡¹</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{AxiosRequestConfig}</span><span style="color: var(--shiki-token-comment)"> axiosåŸç”Ÿçš„é…ç½®é€‰</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)"> */</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IHttpRequestConfig</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    interceptors</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IinterceptorHooks</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸ›µ<strong>ä½¿ç”¨è¯´æ˜</strong>ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">import</span><span style="color: var(--shiki-color-text)"> { IHttpRequestConfig</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> IinterceptorHooks } </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;./types&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    axios</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosInstance</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    interceptors</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IinterceptorHooks</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">(config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IHttpRequestConfig</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// è§£æ„è‡ªå®šä¹‰çš„å±æ€§</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> { </span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)"> } </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.axios </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.create</span><span style="color: var(--shiki-color-text)">(AxiosRequestConfig)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// å­˜å‚¨è‡ªå®šä¹‰æ‹¦æˆªHooks or ç›´æ¥ use() ä½¿ç”¨</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.interceptors </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> interceptors</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// ä¼ å…¥è‡ªå®šä¹‰è¯·æ±‚æ‹¦æˆªå™¨Hooks</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">request</span><span style="color: var(--shiki-token-function)">.use</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.beforeRequestInterceptor</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.requestErrorInterceptor</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// ä¼ å…¥è‡ªå®šä¹‰å“åº”æ‹¦æˆªå™¨Hooks</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">response</span><span style="color: var(--shiki-token-function)">.use</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.responseSuccessInterceptor</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.responseFailInterceptor</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        )</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// æ‰©å±•åçš„å®ä¾‹åŒ–...â›µ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)"> interceptors</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     </span><span style="color: var(--shiki-token-comment)">// ... è‡ªå®šä¹‰çš„æ‹¦æˆªHooks</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     beforeRequestInterceptor</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> (config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IHttpRequestConfig</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">token</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">localStorage</span><span style="color: var(--shiki-token-function)">.getItem</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;token&#39;</span><span style="color: var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (token </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-color-text)">.headers) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">             </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">headers</span><span style="color: var(--shiki-color-text)">.Authorization </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> token</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)"> }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…-æ‹¦æˆªå™¨-æ‰€æœ‰å®ä¾‹å…±äº«" tabindex="-1"><a class="header-anchor" href="#å°è£…-æ‹¦æˆªå™¨-æ‰€æœ‰å®ä¾‹å…±äº«" aria-hidden="true">#</a> å°è£…-æ‹¦æˆªå™¨(æ‰€æœ‰å®ä¾‹å…±äº«)</h3>
<blockquote>
<p>æ— è®ºå­˜åœ¨å¤šå°‘ä¸ªå®ä¾‹çš„ Httpï¼Œæ‰€æœ‰å®ä¾‹éƒ½ä¼šå…±äº«çš„åŒä¸€å¥—æ‹¦æˆªå™¨ï¼Œåœ¨ class ä¸­å›ºå®šçš„</p>
</blockquote>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Http</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    axios</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosInstance</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">(config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IHttpRequestConfig</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// ...å•ä¸ªå®ä¾‹ç‹¬äº«æ‹¦æˆªå™¨å¤„ç†ğŸ³</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// æ‰€æœ‰å®ä¾‹å…±äº«çš„æ‹¦æˆª-è¯·æ±‚æ‹¦æˆªå™¨ğŸŸ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">request</span><span style="color: var(--shiki-token-function)">.use</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (config) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            }</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (error) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.reject</span><span style="color: var(--shiki-color-text)">(error)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// æ‰€æœ‰å®ä¾‹å…±äº«çš„æ‹¦æˆª-å“åº”æ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">response</span><span style="color: var(--shiki-token-function)">.use</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (response) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// 2xx èŒƒå›´å†…çš„çŠ¶æ€ç éƒ½ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> response</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            }</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (error) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// è¶…å‡º 2xx èŒƒå›´çš„çŠ¶æ€ç éƒ½ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.reject</span><span style="color: var(--shiki-color-text)">(error)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        )</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…-æ‹¦æˆªå™¨-å•ä¸ªè¯·æ±‚ç‹¬äº«" tabindex="-1"><a class="header-anchor" href="#å°è£…-æ‹¦æˆªå™¨-å•ä¸ªè¯·æ±‚ç‹¬äº«" aria-hidden="true">#</a> å°è£…-æ‹¦æˆªå™¨(å•ä¸ªè¯·æ±‚ç‹¬äº«)</h3>
<blockquote>
<p>åœ¨ axios åŸç”Ÿçš„ config(AxiosRequestConfig) ä¸­ï¼Œå­˜åœ¨ä¸¤ä¸ªå…è®¸å¯¹è¯·æ±‚orå“åº”çš„æ•°æ®è¿›è¡Œè½¬åŒ–å¤„ç†ï¼š</p>
<div class="language-javascript ext-js line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// `transformRequest` å…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// å®ƒåªèƒ½ç”¨äº &#39;PUT&#39;, &#39;POST&#39; å’Œ &#39;PATCH&#39; è¿™å‡ ä¸ªè¯·æ±‚æ–¹æ³•</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// æ•°ç»„ä¸­æœ€åä¸€ä¸ªå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ ä¸€ä¸ªBufferå®ä¾‹ï¼ŒArrayBufferï¼ŒFormDataï¼Œæˆ– Stream</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// ä½ å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ã€‚</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">transformRequest</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (data</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> headers) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// å¯¹å‘é€çš„ data è¿›è¡Œä»»æ„è½¬æ¢å¤„ç†</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> data;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}]</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// `transformResponse` åœ¨ä¼ é€’ç»™ then/catch å‰ï¼Œå…è®¸ä¿®æ”¹å“åº”æ•°æ®</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">transformResponse</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (data) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// å¯¹æ¥æ”¶çš„ data è¿›è¡Œä»»æ„è½¬æ¢å¤„ç†</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> data;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}]</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote>
<p>ç”±äº<code v-pre>transformRequestã€transformResponse</code>ä¸º Axios åŸç”Ÿçš„APIï¼Œæ‰€ä»¥å°½é‡ä¸å»æ”¹å˜åŸæœ‰çš„ config API</p>
<blockquote>
<p>ğŸŸåœ¨éœ€è¦ä¸ä¿®æ”¹åŸç”Ÿ Axios config æƒ…å†µä¸‹ï¼Œ<strong>æ‰©å±•å•ä¸ªè¯·æ±‚ç‹¬äº«çš„æ‹¦æˆªå™¨</strong>æ—¶</p>
<p>ğŸ³class å°è£…çš„æ–¹æ³•ï¼š<code v-pre>request(config: AxiosRequestConfig){}</code>å‚æ•°ä¸­<strong>ä¸èƒ½å†ä½¿ç”¨åŸç”Ÿ<code v-pre>AxiosRequestConfig</code>ä½œä¸ºå‚æ•°çš„æ³¨è§£</strong></p>
<p>ğŸ«•å‰é¢æåˆ°è¿‡ï¼Œrequest ä¸­çš„ config å‚æ•°ä¸å®ä¾‹åŒ–æ—¶ä¼ å…¥çš„å‚æ•°æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥<strong>åœ¨è¿™é‡ŒåŒæ ·å¯ä»¥ä½¿ç”¨<code v-pre>IHttpRequestConfig</code>ï¼Œä½œä¸º request çš„å‚æ•°æ³¨è§£</strong></p>
</blockquote>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">/**</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* axios#request(config)</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{*}</span><span style="color: var(--shiki-token-comment)"> config</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">* </span><span style="color: var(--shiki-token-keyword)">@returns</span><span style="color: var(--shiki-token-comment)"> </span><span style="color: var(--shiki-token-function)">{*}</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">*/</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">request</span><span style="color: var(--shiki-color-text)">(config: AxiosRequestConfig) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// ...æ”¹ä¸º AxiosRequestConfig -&gt; IHttpRequestConfig</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">request</span><span style="color: var(--shiki-color-text)">(config: IHttpRequestConfig) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// ... åœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰ï¼Œæ‰§è¡Œå•ä¸ªè¯·æ±‚ç‹¬äº«çš„æ‹¦æˆªå™¨(?)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">(config)</span><span style="color: var(--shiki-token-function)">.then</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    	</span><span style="color: var(--shiki-token-comment)">// ... </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    )</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å…·ä½“ä»£ç å®ç°ï¼š</strong></p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// Http å°è£…çš„requestğŸ«•</span></span>
<span class="line"><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">request</span><span style="color: var(--shiki-color-text)">(config: IHttpRequestConfig) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     </span><span style="color: var(--shiki-token-comment)">// å­˜åœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰æ‹¦æˆªå™¨Hooks(è¯·æ±‚ä¹‹å‰)ğŸ€</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.beforeRequestInterceptor) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-comment)">// ç«‹å³æ‰§è¡ŒbeforeRequestInterceptoræ–¹æ³•ï¼Œä¼ å…¥configå¤„ç†è¿”å›æ–°çš„å¤„ç†åçš„config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         config </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.beforeRequestInterceptor</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.axios</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-function)">.then</span><span style="color: var(--shiki-color-text)">((result) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-comment)">// å­˜åœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰æ‹¦æˆªå™¨Hooks(å“åº”æˆåŠŸ)ğŸƒ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.responseSuccessInterceptor) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">             </span><span style="color: var(--shiki-token-comment)">// ç«‹å³æ‰§è¡ŒbeforeRequestInterceptoræ–¹æ³•ï¼Œä¼ å…¥configå¤„ç†è¿”å›æ–°çš„å¤„ç†åçš„config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">             result </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.responseSuccessInterceptor</span><span style="color: var(--shiki-color-text)">(result)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> result</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     })</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-function)">.catch</span><span style="color: var(--shiki-color-text)">((error) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-comment)">// å­˜åœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰æ‹¦æˆªå™¨Hooks(å“åº”å¤±è´¥)ğŸŒ„</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-color-text)">?.responseFailInterceptor) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">             </span><span style="color: var(--shiki-token-comment)">// ç«‹å³æ‰§è¡ŒbeforeRequestInterceptoræ–¹æ³•ï¼Œä¼ å…¥configå¤„ç†è¿”å›æ–°çš„å¤„ç†åçš„config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">             error </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.responseFailInterceptor</span><span style="color: var(--shiki-color-text)">(error)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">         </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> error</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">     })</span></span>
<span class="line"><span style="color: var(--shiki-color-text)"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// æ‰§è¡Œ request æ–¹æ³•ï¼Œä¼ å…¥æ‹¦æˆªå™¨å¤„ç†ğŸŒï¼Œå¦‚ï¼š</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    url</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;/api/addUser&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    methed</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;POST&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    interceptors</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-function)">beforeRequestInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)">(config) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// ...å¤„ç†configæ•°æ®</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        }</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// ...è¯·æ±‚é”™è¯¯å¤„ç†ä¸æ‹¦æˆª</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-function)">responseSuccessInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)">(result) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> result</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote>
<p>æ³¨æ„ï¼šå½“å­˜åœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰è¯·æ±‚æ‹¦æˆªå™¨æ—¶ï¼Œåº”å½“åœ¨å‘é€è¯·æ±‚ä¹‹å‰<strong>ç«‹å³æ‰§è¡Œ beforeRequestInterceptor æ–¹æ³•</strong>ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¼ å…¥åˆ° use() å›è°ƒï¼Œæ‰§è¡Œè¯·æ±‚æ‹¦æˆªæ–¹æ³•å¤„ç†å®Œä¹‹åè¿”å›ä¸€ä¸ªç»è¿‡å¤„ç†çš„ configï¼Œåœ¨ä¼ å…¥åˆ°è¯·æ±‚æ–¹æ³•ä¸­ï¼Œå‘é€è¯·æ±‚</p>
<p>å…¶å®ƒçš„å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰å“åº”æ‹¦æˆªå™¨ä¸€æ ·</p>
</blockquote>
<h3 id="è£…ä¿®-http-class" tabindex="-1"><a class="header-anchor" href="#è£…ä¿®-http-class" aria-hidden="true">#</a> è£…ä¿® Http class</h3>
<h4 id="è¿”å›ç»è¿‡" tabindex="-1"><a class="header-anchor" href="#è¿”å›ç»è¿‡" aria-hidden="true">#</a> è¿”å›ç»è¿‡</h4>
<blockquote>
<p>åœ¨å“åº”æ•°æ®æ—¶å€™(å“åº”æ‹¦æˆªå™¨)ï¼Œ<strong>Axios ä¸ºæ•°æ®åœ¨å¤–å±‚åŒ…è£…äº†ä¸€å±‚å¯¹è±¡ï¼Œåå°è¿”å›çš„æ•°æ®å°±å­˜åœ¨äº result çš„ data ä¸­</strong>ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ•°æ®å†ä¸€æ­¥çš„å¤„ç†ï¼Œæ‰’å¼€æœ€å¤–å±‚çš„çš®</p>
<p><strong>æ³¨æ„ï¼šAxios åœ¨å¤–å±‚åŒ…è£…çš„å¯¹è±¡æ•°æ®ï¼Œå…¶å®åœ¨æŸäº›æƒ…å†µä¸‹æ˜¯éœ€è¦ result ä¸­çš„ä¸€äº›å±æ€§æ•°æ®çš„ï¼Œå¹¶ä¸ä»…ä»…éœ€è¦ dataï¼Œæ¯”å¦‚è¿”å›æ ¼å¼ä¸ºæ–‡ä»¶æ•°æ®ä¸­ï¼Œéœ€è¦ headers ä¸­çš„ä¸€äº›æ•°æ®å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œå‘½åç­‰...</strong></p>
<p>è¿™é‡Œçš„æ‰’çš®å¤„ç†ï¼Œé€»è¾‘åº”å½“å±äºæ‰€æœ‰å®ä¾‹å…±äº«çš„ä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œ<strong>å…·ä½“å·¥å…·éœ€è¦è¿›è¡Œå¤„ç†</strong></p>
</blockquote>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// æ‰€æœ‰å®ä¾‹å…±äº«çš„æ‹¦æˆª-å“åº”æ‹¦æˆªå™¨</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">response</span><span style="color: var(--shiki-token-function)">.use</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (response) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// è¿”å›ä¸ºæ–‡ä»¶æµæ—¶,ç›´æ¥è¿”å›(æ–‡ä»¶éœ€è¦å•ç‹¬å¤„ç†)ğŸª‚</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> ([</span><span style="color: var(--shiki-token-string-expression)">&#39;blob&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;arraybuffer&#39;</span><span style="color: var(--shiki-color-text)">]</span><span style="color: var(--shiki-token-function)">.includes</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">response</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">request</span><span style="color: var(--shiki-color-text)">.responseType)) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// if (response.headers[&#39;content-disposition&#39;]) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//     let fileName = response.headers[&#39;content-disposition&#39;].split(&#39;filename=&#39;)[1]</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//     fileName = decodeURI(fileName)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//     return {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//         data: response.data,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//         fileName</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">//     }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> response</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// æ ¹æ®ä¸šåŠ¡ç  or çŠ¶æ€ç ...è¿›è¡Œåˆ¤æ–­</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// æ‰’çš®ğŸ›µ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">response</span><span style="color: var(--shiki-color-text)">.data</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (error) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// è¶…å‡º 2xx èŒƒå›´çš„çŠ¶æ€ç éƒ½ä¼šè§¦å‘è¯¥å‡½æ•°ã€‚</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-function)">.reject</span><span style="color: var(--shiki-color-text)">(error)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="request-è¿”å›æ•°æ®ç»“æ„-dto" tabindex="-1"><a class="header-anchor" href="#request-è¿”å›æ•°æ®ç»“æ„-dto" aria-hidden="true">#</a> request è¿”å›æ•°æ®ç»“æ„(DTO)</h4>
<p>å®šä¹‰è¿”å›æ•°æ®ç±»å‹æ³¨è§£</p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// æœ€ç»ˆæ•°æ®ç±»å‹æ³¨è§£</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IDateType</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    [key</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">]</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// axios è¿”å›çš„æ•°æ®ç±»å‹æ³¨è§£ï¼ŒIDateType === T</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IDTO</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">&gt; {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    code</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    data</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">T</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    message</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    state</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">number</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    [prop</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">]</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// è¯·æ±‚æ–¹æ³•ï¼Œä¼ å…¥æ³¨è§£</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">axios</span><span style="color: var(--shiki-token-function)">.request</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">IDTO</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">IDateType</span><span style="color: var(--shiki-color-text)">&gt;&gt;({</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    url</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;/api/addUser&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    methed</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;POST&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">})</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±äºåœ¨æ‰€æœ‰å®ä¾‹å…±äº«çš„å“åº”æ‹¦æˆªå™¨ä¸­ï¼Œä¿®æ”¹äº†è¿”å›çš„æ•°æ®ç»“æ„<code v-pre>return response.data</code>,<strong>åˆ°è¾¾æ–¹æ³•å“åº”æ‹¦æˆªå™¨ä¸­çš„æ•°æ®ç±»å‹å·²ç»ä¸å†æ˜¯<code v-pre>AxiosResponse</code>ï¼Œå¯¼è‡´åœ¨å“åº”æˆåŠŸçš„æ‹¦æˆªå™¨ä¸­ç±»å‹é”™è¯¯æ— æ³•èµ‹å€¼ï¼Œä»¥åŠ.thenè¿”å›çš„ç±»å‹ä¸æ­£ç¡®æ— æ³•è¿”å›,æ­£ç¡®åº”è¯¥ä¸º<code v-pre>DTO</code>ç±»å‹</strong>ï¼Œè§£å†³æ–¹æ¡ˆï¼š</p>
<div class="language-typescript ext-ts line-numbers-mode"><pre v-pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// ä¿®æ”¹ AxiosRequestConfig ç±»å‹æ³¨è§£ï¼Œé»˜è®¤ç±»å‹ä¸ºåŸæ¥çš„ AxiosResponseï¼Œä¼ é€’åˆ°å“åº”æˆåŠŸçš„æ‹¦æˆªä¸­è¿›è¡Œæ³›å‹æ³¨è§£ï¼Œç”¨äºåœ¨æ–¹æ³•ä¸­é‡æ–°ä¿®æ”¹è¿”å›çš„æ•°æ®ç±»å‹</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// æœ€ç»ˆçš„æ³›å‹ç±»å‹æ³¨è§£åˆ°è¾¾ responseSuccessInterceptor ä¸­</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">interceptorHooks</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)">&gt; {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">beforeRequestInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (config</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">requestErrorInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (error</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">responseSuccessInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (result</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">T</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">responseFailInterceptor</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> (error</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">any</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">type</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IinterceptorHooks</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponse</span><span style="color: var(--shiki-color-text)">&gt; </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Partial</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">interceptorHooks</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)">&gt;&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IHttpRequestConfig</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosResponse</span><span style="color: var(--shiki-color-text)">&gt; </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">AxiosRequestConfig</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    interceptors</span><span style="color: var(--shiki-token-keyword)">?:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">IinterceptorHooks</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// ä¿®æ”¹ Http class requestæ–¹æ³•ï¼Œé€šè¿‡ æ³›å‹ T æ¥å—æ–¹æ³•ä¼ è¾¾è¿‡æ¥çš„ DTO ç±»å‹æ³¨è§£ï¼Œä¼ é€’åˆ° IHttpRequestConfig ä¸­ä¿®æ”¹ responseSuccessInterceptor çš„å‚æ•°ç±»å‹æ³¨è§£ä»¥åŠè¿”å›å€¼æ³¨è§£ï¼Œåœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰æ‹¦æˆªå™¨ä¸­å°±å¯ä»¥æ¥å—å‚æ•°ï¼Œå¹¶ä¸”è¿”å›æ­£ç¡®çš„ DTO ç±»å‹æ•°æ®</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// ç”±äºåœ¨ä¸‹é¢çš„ this.axios.request() æ–¹æ³•ä¸­ï¼Œè¿”å›çš„æ•°æ®å·²ç»è¢«ä¸Šä¸€ä¸ªæ‹¦æˆªå™¨æ‰’çš®ä¿®æ”¹äº†ï¼Œè¿”å›çš„ result ç±»å‹æ³¨è§£ä¸­å­˜åœ¨ç±»å‹ä¸æ­£ç¡®æƒ…å†µ(æ­£ç¡®è¿”å›åº”è¿”å›response.dataçš„ç±»å‹æ³¨è§£)ï¼Œå®é™…è¿”å›ä¸º AxiosResponse&lt;any,any&gt;ç±»å‹æ³¨è§£ï¼Œå¯¼è‡´æ•°æ®è¿”å›åˆ°æœ€å¤–å±‚æ–¹æ³•æ—¶ç¼–è¾‘å™¨æŠ¥é”™(æœ€å¤–å±‚æ¥å— DTO ç±»å‹)ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨ä¿®æ”¹this.axios.request() æ–¹æ³•ä¸­è¿”å›çš„ç±»å‹æ³¨è§£ this.axios.request&lt;any, T&gt;()</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">request</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">T</span><span style="color: var(--shiki-color-text)">&gt;(config: IHttpRequestConfig</span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-token-constant)">T</span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)">): </span><span style="color: var(--shiki-token-constant)">Promise</span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-token-constant)">T</span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> {  </span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        return this.axios</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            .request&lt;any</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> T&gt;(config)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            .then((result) =&gt; {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// å­˜åœ¨å•ä¸ªæ–¹æ³•ç‹¬äº«è‡ªå®šä¹‰æ‹¦æˆªå™¨Hooks(å“åº”æˆåŠŸ)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-function)">if</span><span style="color: var(--shiki-color-text)"> (config.interceptors?.responseSuccessInterceptor) {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                    </span><span style="color: var(--shiki-token-comment)">// ç«‹å³æ‰§è¡ŒbeforeRequestInterceptoræ–¹æ³•ï¼Œä¼ å…¥configå¤„ç†è¿”å›æ–°çš„å¤„ç†åçš„config</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                    result </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">config</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">interceptors</span><span style="color: var(--shiki-token-function)">.responseSuccessInterceptor</span><span style="color: var(--shiki-color-text)">(result)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                }</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                return result</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            })</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-function)">.catch</span><span style="color: var(--shiki-color-text)">((error) </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">              </span><span style="color: var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">            })</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº" tabindex="-1"><a class="header-anchor" href="#æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº" aria-hidden="true">#</a> æ‹¦æˆªå™¨æ‰§è¡Œé¡ºåº</h3>
<blockquote>
<p>ç”±äºåœ¨ constructor(æ„é€ å‡½æ•°) <strong>ä»£ç é¡ºåºï¼šå•ä¸ªå®ä¾‹ç‹¬äº«æ‹¦æˆªå™¨  -&gt;  æ‰€æœ‰å®ä¾‹å…±äº«æ‹¦æˆªå™¨  -&gt;...</strong></p>
<p>ğŸŒ„<strong>å•ä¸ªå®ä¾‹ç‹¬äº«æ‹¦æˆªå™¨ä½äºæ‰€æœ‰å®ä¾‹å…±äº«æ‹¦æˆªå™¨ä¹‹å‰</strong>ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š</p>
<p><strong><code v-pre>æ‰€æœ‰å®ä¾‹å…±äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  å•ä¸ªå®ä¾‹ç‹¬äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  å•ä¸ªå®ä¾‹ç‹¬äº«å“åº”æ‹¦æˆªå™¨  -&gt;  æ‰€æœ‰å®ä¾‹å…±äº«å“åº”æ‹¦æˆªå™¨</code></strong></p>
<p>åä¹‹ï¼Œåˆ™ï¼š</p>
<p>ğŸŒ…<strong>æ‰€æœ‰å®ä¾‹å…±äº«æ‹¦æˆªå™¨ä½äºä¹‹å‰å•ä¸ªå®ä¾‹ç‹¬äº«æ‹¦æˆªå™¨</strong>ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š</p>
<p><strong><code v-pre>å•ä¸ªå®ä¾‹ç‹¬äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  æ‰€æœ‰å®ä¾‹å…±äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  æ‰€æœ‰å®ä¾‹å…±äº«å“åº”æ‹¦æˆªå™¨  -&gt;  å•ä¸ªå®ä¾‹ç‹¬äº«å“åº”æ‹¦æˆªå™¨</code></strong></p>
<p>ğŸŒ<strong>å•ä¸ªæ–¹æ³•ç‹¬äº«æ‹¦æˆªå™¨(å•ä¸ªå®ä¾‹ç‹¬äº«æ‹¦æˆªå™¨ä½äºæ‰€æœ‰å®ä¾‹å…±äº«æ‹¦æˆªå™¨ä¹‹å‰)</strong>ï¼Œæ‰§è¡Œé¡ºåºä¸ºï¼š</p>
<p><strong><code v-pre>å•ä¸ªæ–¹æ³•è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  å®ä¾‹å…±äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  å•ä¸ªç‹¬äº«è¯·æ±‚æ‹¦æˆªå™¨  -&gt;  å•ä¸ªç‹¬äº«å“åº”æ‹¦æˆªå™¨  -&gt;  å®ä¾‹å…±äº«å“åº”æ‹¦æˆªå™¨  -&gt;  å•ä¸ªæ–¹æ³•å“åº”æ‹¦æˆªå™¨</code></strong></p>
<p>è¯·æ±‚æ‹¦æˆªï¼šconstructor<strong>å…ˆæ‰§è¡Œçš„ä»£ç </strong>(use())ï¼Œæ‹¦æˆªå™¨é‡Œé¢çš„å›è°ƒhook<strong>åè¢«æ‰§è¡Œ</strong>ï¼Œåä¹‹ï¼Œ<strong>å…ˆè¢«æ‰§è¡Œ</strong></p>
<p>å“åº”æ‹¦æˆªï¼šconstructor<strong>å…ˆæ‰§è¡Œçš„ä»£ç </strong>(use())ï¼Œæ‹¦æˆªå™¨é‡Œé¢çš„å›è°ƒhook<strong>å…ˆè¢«æ‰§è¡Œ</strong>ï¼Œåä¹‹ï¼Œ<strong>åè¢«æ‰§è¡Œ</strong></p>
<p>éœ€è¦ä¿®æ”¹æ‰§è¡Œé¡ºåºå¯è°ƒæ•´ä»£ç çš„æ‰§è¡Œé¡ºåº</p>
</blockquote>
<h3 id="æ“ä½œåœºæ™¯æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#æ“ä½œåœºæ™¯æ§åˆ¶" aria-hidden="true">#</a> æ“ä½œåœºæ™¯æ§åˆ¶</h3>
<blockquote>
<p>ç”±äºå­˜åœ¨ä¸‰ç§æ‹¦æˆªå™¨ï¼Œå­˜åœ¨ä¸€äº›å¤æ‚çš„æ“ä½œåœºæ™¯æ—¶ï¼Œæ¯”å¦‚ï¼Œé€šè¿‡ç»™æ‰€æœ‰å®ä¾‹æˆ–è€…å•ç‹¬å®ä¾‹æå‰æ·»åŠ äº†æ“ä½œ<code v-pre>loadingã€é”™è¯¯æ•è·...</code>ï¼Œä½†æ˜¯ç°åœ¨éœ€è¦åœ¨æŸä¸ªè¯·æ±‚æ–¹æ³•ä¸­ä¸è¿›è¡Œæ­¤æ“ä½œæ—¶ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡ç»§ç»­æ‰©å±•ç‰¹å®šçš„ IHttpRequestConfig ç±»å‹å±æ€§ï¼Œå› ä¸º<code v-pre>å•ä¸ªæ–¹æ³•è¯·æ±‚æ‹¦æˆªå™¨æ˜¯æœ€å…ˆæ‰§è¡Œ</code>çš„ï¼ŒIHttpRequestConfig é…ç½®é¡¹ï¼Œåœ¨<code v-pre>æ‰€æœ‰çš„æ‹¦æˆªå™¨ä¸­æ˜¯å…±äº«çš„</code>ï¼Œå±‚çº§ä¼ é€’çš„ï¼Œ<code v-pre>åœ¨æ‹¦æˆªå™¨ä¸­åˆ¤æ–­ç‰¹å®šçš„å±æ€§å€¼</code>å…³é—­ä¸éœ€è¦çš„æ“ä½œ</strong></p>
</blockquote>
</div></template>
