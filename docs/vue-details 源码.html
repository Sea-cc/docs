<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://kiyan-a.github.io/sev/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html"><meta property="og:site_name" content="K"><meta property="og:title" content="Vue"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-08T14:32:31.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-11-08T14:32:31.000Z"><link rel="icon" type="svg" href="/logo.svg"><title>Vue | K</title><meta name="description" content="è®°å½•æˆé•¿,ç›¸ä¿¡è¿‡ç¨‹...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/docs/assets/style.0d78e735.css">
    <link rel="modulepreload" href="/docs/assets/app.4ddfd4cd.js"><link rel="modulepreload" href="/docs/assets/vue-details æºç .html.8ccd6020.js"><link rel="modulepreload" href="/docs/assets/vue-details æºç .html.b752ae5f.js"><link rel="prefetch" href="/docs/assets/index.html.f5dd38ac.js"><link rel="prefetch" href="/docs/assets/exhibition.html.c7a89bd0.js"><link rel="prefetch" href="/docs/assets/article1.html.b6f368df.js"><link rel="prefetch" href="/docs/assets/article2.html.dfa3f786.js"><link rel="prefetch" href="/docs/assets/Axioså°è£….html.0d4a89d1.js"><link rel="prefetch" href="/docs/assets/ES6.html.e471b51d.js"><link rel="prefetch" href="/docs/assets/about.html.4f7c1c10.js"><link rel="prefetch" href="/docs/assets/accuracyProblem.html.663f4a84.js"><link rel="prefetch" href="/docs/assets/dev.html.528e106e.js"><link rel="prefetch" href="/docs/assets/disable.html.9b3a36e1.js"><link rel="prefetch" href="/docs/assets/for Js.html.2ccd5b0c.js"><link rel="prefetch" href="/docs/assets/markdown.html.c1569dc6.js"><link rel="prefetch" href="/docs/assets/mate.html.72ae4231.js"><link rel="prefetch" href="/docs/assets/nest.html.9d980397.js"><link rel="prefetch" href="/docs/assets/new Linux.html.f80b0124.js"><link rel="prefetch" href="/docs/assets/uni-app.html.ff3a7e0b.js"><link rel="prefetch" href="/docs/assets/vite.html.8c6355e5.js"><link rel="prefetch" href="/docs/assets/vue3.html.772fa207.js"><link rel="prefetch" href="/docs/assets/webpack.html.f45c918a.js"><link rel="prefetch" href="/docs/assets/å¼€å‘è§„èŒƒ.html.aeb36f22.js"><link rel="prefetch" href="/docs/assets/æ–‡ä»¶èµ„æºå¤„ç†.html.9dfa65ef.js"><link rel="prefetch" href="/docs/assets/index.html.9bd4fde8.js"><link rel="prefetch" href="/docs/assets/index.html.16ef35e4.js"><link rel="prefetch" href="/docs/assets/disable.html.4262b987.js"><link rel="prefetch" href="/docs/assets/encrypt.html.9cb1df49.js"><link rel="prefetch" href="/docs/assets/markdown.html.d9f34491.js"><link rel="prefetch" href="/docs/assets/page.html.bc7733b7.js"><link rel="prefetch" href="/docs/assets/404.html.67a54621.js"><link rel="prefetch" href="/docs/assets/index.html.6bb212ad.js"><link rel="prefetch" href="/docs/assets/index.html.933b48b1.js"><link rel="prefetch" href="/docs/assets/index.html.f325fe48.js"><link rel="prefetch" href="/docs/assets/index.html.e79b2fec.js"><link rel="prefetch" href="/docs/assets/index.html.6b0490c9.js"><link rel="prefetch" href="/docs/assets/index.html.273f2371.js"><link rel="prefetch" href="/docs/assets/index.html.b73cffd4.js"><link rel="prefetch" href="/docs/assets/index.html.0bc2113b.js"><link rel="prefetch" href="/docs/assets/index.html.1c609236.js"><link rel="prefetch" href="/docs/assets/index.html.ca6e47e4.js"><link rel="prefetch" href="/docs/assets/index.html.92e0a1cf.js"><link rel="prefetch" href="/docs/assets/index.html.2e28146c.js"><link rel="prefetch" href="/docs/assets/index.html.3c81acc3.js"><link rel="prefetch" href="/docs/assets/index.html.f592b8c2.js"><link rel="prefetch" href="/docs/assets/index.html.dcea69d7.js"><link rel="prefetch" href="/docs/assets/index.html.7c169c44.js"><link rel="prefetch" href="/docs/assets/index.html.64497277.js"><link rel="prefetch" href="/docs/assets/index.html.2cf1837f.js"><link rel="prefetch" href="/docs/assets/exhibition.html.92a863a1.js"><link rel="prefetch" href="/docs/assets/article1.html.8e9e72c2.js"><link rel="prefetch" href="/docs/assets/article2.html.e9ae525a.js"><link rel="prefetch" href="/docs/assets/Axioså°è£….html.2097d37c.js"><link rel="prefetch" href="/docs/assets/ES6.html.17ed64fb.js"><link rel="prefetch" href="/docs/assets/about.html.d04ff1c4.js"><link rel="prefetch" href="/docs/assets/accuracyProblem.html.b966a765.js"><link rel="prefetch" href="/docs/assets/dev.html.aef6b112.js"><link rel="prefetch" href="/docs/assets/disable.html.a30ff643.js"><link rel="prefetch" href="/docs/assets/for Js.html.727aa995.js"><link rel="prefetch" href="/docs/assets/markdown.html.f2b9db12.js"><link rel="prefetch" href="/docs/assets/mate.html.ed649eed.js"><link rel="prefetch" href="/docs/assets/nest.html.061a8959.js"><link rel="prefetch" href="/docs/assets/new Linux.html.cea3ca1d.js"><link rel="prefetch" href="/docs/assets/uni-app.html.d3c7e450.js"><link rel="prefetch" href="/docs/assets/vite.html.e7565562.js"><link rel="prefetch" href="/docs/assets/vue3.html.2ab4f6e7.js"><link rel="prefetch" href="/docs/assets/webpack.html.cbf125ad.js"><link rel="prefetch" href="/docs/assets/å¼€å‘è§„èŒƒ.html.3383673d.js"><link rel="prefetch" href="/docs/assets/æ–‡ä»¶èµ„æºå¤„ç†.html.5f4bf217.js"><link rel="prefetch" href="/docs/assets/index.html.ba6f4fe4.js"><link rel="prefetch" href="/docs/assets/index.html.760cda5f.js"><link rel="prefetch" href="/docs/assets/disable.html.9a2e30a2.js"><link rel="prefetch" href="/docs/assets/encrypt.html.1f225bac.js"><link rel="prefetch" href="/docs/assets/markdown.html.e1043843.js"><link rel="prefetch" href="/docs/assets/page.html.b9c69c16.js"><link rel="prefetch" href="/docs/assets/404.html.c4517191.js"><link rel="prefetch" href="/docs/assets/index.html.6a313bda.js"><link rel="prefetch" href="/docs/assets/index.html.6f016ddd.js"><link rel="prefetch" href="/docs/assets/index.html.cafa9d38.js"><link rel="prefetch" href="/docs/assets/index.html.27652804.js"><link rel="prefetch" href="/docs/assets/index.html.53d408f3.js"><link rel="prefetch" href="/docs/assets/index.html.0557a2aa.js"><link rel="prefetch" href="/docs/assets/index.html.f60d8894.js"><link rel="prefetch" href="/docs/assets/index.html.4ee8e38c.js"><link rel="prefetch" href="/docs/assets/index.html.01b0303d.js"><link rel="prefetch" href="/docs/assets/index.html.74f8235e.js"><link rel="prefetch" href="/docs/assets/index.html.585712a1.js"><link rel="prefetch" href="/docs/assets/index.html.6853050a.js"><link rel="prefetch" href="/docs/assets/index.html.b9445087.js"><link rel="prefetch" href="/docs/assets/index.html.5a4cdc76.js"><link rel="prefetch" href="/docs/assets/index.html.7c5a19a6.js"><link rel="prefetch" href="/docs/assets/index.html.e92b39aa.js"><link rel="prefetch" href="/docs/assets/index.html.e784167c.js"><link rel="prefetch" href="/docs/assets/404.d0fb624d.js"><link rel="prefetch" href="/docs/assets/Layout.4c5fb240.js"><link rel="prefetch" href="/docs/assets/Slide.86c9d9fb.js"><link rel="prefetch" href="/docs/assets/Blog.8ef26a60.js"><link rel="prefetch" href="/docs/assets/auto.esm.36809f22.js"><link rel="prefetch" href="/docs/assets/index.daae04bf.js"><link rel="prefetch" href="/docs/assets/index.1842ee54.js"><link rel="prefetch" href="/docs/assets/mermaid.esm.min.d8b76e20.js"><link rel="prefetch" href="/docs/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/docs/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/docs/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/docs/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/docs/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/docs/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/docs/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/docs/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/docs/" class="brand"><img class="logo" src="/docs/logo.svg" alt="K"><!----><span class="site-name hide-in-pad">K</span></a><!----></div><div class="navbar-center"><!----><!----><!----></div><div class="navbar-right"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/docs/docs/about.html" class="nav-link" aria-label="ğŸ‰æ–‡æ¡£"><!---->ğŸ‰æ–‡æ¡£<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ğŸª‚ç»„ä»¶"><span class="title"><!---->ğŸª‚ç»„ä»¶</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/components/article1.html" class="nav-link" aria-label="æ–‡ç«  1"><span class="icon iconfont icon-edit" style=""></span>æ–‡ç«  1<!----></a></li><li class="dropdown-item"><a href="/docs/components/article2.html" class="nav-link" aria-label="æ–‡ç«  2"><span class="icon iconfont icon-edit" style=""></span>æ–‡ç«  2<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/docs/log/" class="nav-link" aria-label="ğŸªµæ›´æ–°æ—¥å¿—"><!---->ğŸªµæ›´æ–°æ—¥å¿—<!----></a></div></nav><!----><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><div class="nav-item"><a class="repo-link" href="https://github.com/Kiyan-a" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><a href="/docs/docs/" class="title">ğŸ‰æ–‡æ¡£</a><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/docs/docs/disable.html" class="nav-link sidebar-link sidebar-page" aria-label="å¸ƒå±€ä¸åŠŸèƒ½ç¦ç”¨"><span class="icon iconfont icon-config" style=""></span>å¸ƒå±€ä¸åŠŸèƒ½ç¦ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown å±•ç¤º"><span class="icon iconfont icon-markdown" style=""></span>Markdown å±•ç¤º<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/for%20Js.html" class="nav-link sidebar-link sidebar-page" aria-label="âœï¸ JS æŠ€å·§"><!---->âœï¸ JS æŠ€å·§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/accuracyProblem.html" class="nav-link sidebar-link sidebar-page" aria-label="âœï¸ JS ç²¾åº¦é—®é¢˜"><!---->âœï¸ JS ç²¾åº¦é—®é¢˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86.html" class="nav-link sidebar-link sidebar-page" aria-label="âœï¸ æ–‡ä»¶èµ„æºå¤„ç†"><!---->âœï¸ æ–‡ä»¶èµ„æºå¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/mate.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ‘‘ æ–°çš„ Vue é¡¹ç›®"><!---->ğŸ‘‘ æ–°çš„ Vue é¡¹ç›®<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/ES6.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– ES6"><!---->ğŸ“– ES6<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/nest.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– NestJs"><!---->ğŸ“– NestJs<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/new%20Linux.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– Nginx"><!---->ğŸ“– Nginx<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/uni-app.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– uni-app"><!---->ğŸ“– uni-app<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/vite.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– Vite åŸºæœ¬ä½¿ç”¨"><!---->ğŸ“– Vite åŸºæœ¬ä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/vue3.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– Vue 3"><!---->ğŸ“– Vue 3<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/Axios%E5%B0%81%E8%A3%85.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– åŸºäº typescript äºŒæ¬¡å°è£… axios"><!---->ğŸ“– åŸºäº typescript äºŒæ¬¡å°è£… axios<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/dev.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ“– è°ƒè¯•æŠ€å·§"><!---->ğŸ“– è°ƒè¯•æŠ€å·§<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/about.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ¦š å…³äº"><!---->ğŸ¦š å…³äº<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/webpack.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ› ï¸ Webpack"><!---->ğŸ› ï¸ Webpack<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html" class="nav-link sidebar-link sidebar-page" aria-label="ğŸ› ï¸ å¼€å‘è§„èŒƒ"><!---->ğŸ› ï¸ å¼€å‘è§„èŒƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Vue"><!---->Vue<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#è¯»æºç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¯»æºç "><!---->è¯»æºç <!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#options-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="options Api"><!---->options Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#methods-ä¸­çš„æ–¹æ³•-this-æŒ‡å‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Methods ä¸­çš„æ–¹æ³• this æŒ‡å‘"><!---->Methods ä¸­çš„æ–¹æ³• this æŒ‡å‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#computed-ç®€å†™-ä¸-å®Œæ•´å†™æ³•çš„å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="computed ç®€å†™ ä¸ å®Œæ•´å†™æ³•çš„å¤„ç†"><!---->computed ç®€å†™ ä¸ å®Œæ•´å†™æ³•çš„å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#watch-ç›‘å¬å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="watch ç›‘å¬å™¨"><!---->watch ç›‘å¬å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ä¾èµ–æ³¨å…¥-provide-inject" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¾èµ–æ³¨å…¥ provide inject"><!---->ä¾èµ–æ³¨å…¥ provide inject<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#composition-api-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="composition Api"><!---->composition Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸª‚-setup" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸª‚ setup"><!---->ğŸª‚ setup<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸŸ-reactive-å“åº”å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸŸ reactive å“åº”å¼"><!---->ğŸŸ reactive å“åº”å¼<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ³-ref-å“åº”å¼-å®˜æ–¹-æ¨èå°½é‡ä½¿ç”¨-ref-è€Œä¸æ˜¯-reactive" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ³ ref å“åº”å¼(å®˜æ–¹ï¼šæ¨èå°½é‡ä½¿ç”¨ ref è€Œä¸æ˜¯ reactive)"><!---->ğŸ³ ref å“åº”å¼(å®˜æ–¹ï¼šæ¨èå°½é‡ä½¿ç”¨ ref è€Œä¸æ˜¯ reactive)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸƒ-readonly-åªè¯»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸƒ readonly åªè¯»"><!---->ğŸƒ readonly åªè¯»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸš€-reactive-åˆ¤æ–­-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸš€ Reactive åˆ¤æ–­ Api"><!---->ğŸš€ Reactive åˆ¤æ–­ Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ›µ-torefs-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ›µ toRefs Api"><!---->ğŸ›µ toRefs Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸœï¸-toref-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸœï¸ toRef Api"><!---->ğŸœï¸ toRef Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ™ï¸-unref-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ™ï¸ unref Api"><!---->ğŸ™ï¸ unref Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-isref-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ‰ isRef Api"><!---->ğŸ‰ isRef Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸª…-shallowref-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸª… shallowRef Api"><!---->ğŸª… shallowRef Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ§¸-triggerref-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ§¸ triggerRef Api"><!---->ğŸ§¸ triggerRef Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#å…¶å®ƒ-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¶å®ƒ Api"><!---->å…¶å®ƒ Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¨-computed-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ¨ computed Api"><!---->ğŸ¨ computed Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-watcheffect-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ‰ watchEffect Api"><!---->ğŸ‰ watchEffect Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¡-watch-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ¡ watch Api"><!---->ğŸ¡ watch Api<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ‰ ç”Ÿå‘½å‘¨æœŸ"><!---->ğŸ‰ ç”Ÿå‘½å‘¨æœŸ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ€-vue3-ä¾èµ–æ³¨å…¥-provide-inject" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ€ VUE3 ä¾èµ–æ³¨å…¥ provide inject"><!---->ğŸ€ VUE3 ä¾èµ–æ³¨å…¥ provide inject<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¿-hook" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ¿ Hook"><!---->ğŸ¿ Hook<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ§¸-h-å‡½æ•°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ğŸ§¸ h å‡½æ•°"><!---->ğŸ§¸ h å‡½æ•°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#diff-ç®—æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="diff ç®—æ³•"><!---->diff ç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ğŸª‚ç»„ä»¶</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><a href="/docs/exhibition.html" class="nav-link sidebar-link sidebar-page" aria-label="å¹»ç¯ç‰‡"><!---->å¹»ç¯ç‰‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Vue</h1><!----><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#è¯»æºç " class="router-link-active router-link-exact-active toc-link level2">è¯»æºç </a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#options-api" class="router-link-active router-link-exact-active toc-link level3">options Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#methods-ä¸­çš„æ–¹æ³•-this-æŒ‡å‘" class="router-link-active router-link-exact-active toc-link level3">Methods ä¸­çš„æ–¹æ³• this æŒ‡å‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#computed-ç®€å†™-ä¸-å®Œæ•´å†™æ³•çš„å¤„ç†" class="router-link-active router-link-exact-active toc-link level3">computed ç®€å†™ ä¸ å®Œæ•´å†™æ³•çš„å¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#watch-ç›‘å¬å™¨" class="router-link-active router-link-exact-active toc-link level3">watch ç›‘å¬å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ä¾èµ–æ³¨å…¥-provide-inject" class="router-link-active router-link-exact-active toc-link level3">ä¾èµ–æ³¨å…¥ provide inject</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#composition-api-1" class="router-link-active router-link-exact-active toc-link level3">composition Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸª‚-setup" class="router-link-active router-link-exact-active toc-link level3">ğŸª‚ setup</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸŸ-reactive-å“åº”å¼" class="router-link-active router-link-exact-active toc-link level3">ğŸŸ reactive å“åº”å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ³-ref-å“åº”å¼-å®˜æ–¹-æ¨èå°½é‡ä½¿ç”¨-ref-è€Œä¸æ˜¯-reactive" class="router-link-active router-link-exact-active toc-link level3">ğŸ³ ref å“åº”å¼(å®˜æ–¹ï¼šæ¨èå°½é‡ä½¿ç”¨ ref è€Œä¸æ˜¯ reactive)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸƒ-readonly-åªè¯»" class="router-link-active router-link-exact-active toc-link level3">ğŸƒ readonly åªè¯»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸš€-reactive-åˆ¤æ–­-api" class="router-link-active router-link-exact-active toc-link level3">ğŸš€ Reactive åˆ¤æ–­ Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ›µ-torefs-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ›µ toRefs Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸœï¸-toref-api" class="router-link-active router-link-exact-active toc-link level3">ğŸœï¸ toRef Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ™ï¸-unref-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ™ï¸ unref Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-isref-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ‰ isRef Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸª…-shallowref-api" class="router-link-active router-link-exact-active toc-link level3">ğŸª… shallowRef Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ§¸-triggerref-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ§¸ triggerRef Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#å…¶å®ƒ-api" class="router-link-active router-link-exact-active toc-link level3">å…¶å®ƒ Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¨-computed-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ¨ computed Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-watcheffect-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ‰ watchEffect Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¡-watch-api" class="router-link-active router-link-exact-active toc-link level3">ğŸ¡ watch Api</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ‰-ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active toc-link level3">ğŸ‰ ç”Ÿå‘½å‘¨æœŸ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ€-vue3-ä¾èµ–æ³¨å…¥-provide-inject" class="router-link-active router-link-exact-active toc-link level3">ğŸ€ VUE3 ä¾èµ–æ³¨å…¥ provide inject</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ¿-hook" class="router-link-active router-link-exact-active toc-link level3">ğŸ¿ Hook</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#ğŸ§¸-h-å‡½æ•°" class="router-link-active router-link-exact-active toc-link level3">ğŸ§¸ h å‡½æ•°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html#diff-ç®—æ³•" class="router-link-active router-link-exact-active toc-link level3">diff ç®—æ³•</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="vue" tabindex="-1"><a class="header-anchor" href="#vue" aria-hidden="true">#</a> Vue</h1><blockquote><h4 id="ä»€ä¹ˆæ˜¯æ¸è¿›å¼å¼æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯æ¸è¿›å¼å¼æ¡†æ¶" aria-hidden="true">#</a> <strong>ä»€ä¹ˆæ˜¯æ¸è¿›å¼å¼æ¡†æ¶</strong></h4><p><strong>è¡¨ç¤ºå¯ä»¥åœ¨é¡¹ç›®ä¸­ä¸€ç‚¹ç‚¹æ¥å¼•å…¥å’Œä½¿ç”¨ Vueï¼Œè€Œä¸ä¸€å®šéœ€è¦å…¨éƒ¨å¼•å…¥ä½¿ç”¨ Vueï¼Œæ¥å¼€å‘æ•´ä¸ªé¡¹ç›®</strong></p><p><code>&lt;template&gt;</code> æ ‡ç­¾å¹¶ä¸æ˜¯ Vue ç‰¹æœ‰çš„ï¼Œæ˜¯ HTML ä¸€ä¸ªæ ‡ç­¾ï¼Œä½†æ˜¯å®ƒ(åŒ…æ‹¬å®ƒçš„å†…å®¹)ä¸ä¼šè¢«æµè§ˆå™¨æ¸²æŸ“ï¼Œè€Œæ˜¯ç”¨æ¥è¢« js è„šæœ¬è¯»å–ä½¿ç”¨çš„</p></blockquote><blockquote><h4 id="composition-api" tabindex="-1"><a class="header-anchor" href="#composition-api" aria-hidden="true">#</a> Composition API</h4><p>ğŸŸ Composition API å¯ä»¥å°†ç›¸å…³è”çš„ä»£ç æ”¾åˆ°åŒä¸€å¤„è¿›è¡Œå¤„ç†ï¼Œè€Œä¸éœ€è¦åœ¨å¤šä¸ª Options ä¹‹é—´å¯»æ‰¾</p><h4 id="hooks-å‡½æ•°å¢åŠ ä»£ç çš„å¤ç”¨æ€§" tabindex="-1"><a class="header-anchor" href="#hooks-å‡½æ•°å¢åŠ ä»£ç çš„å¤ç”¨æ€§" aria-hidden="true">#</a> Hooks å‡½æ•°å¢åŠ ä»£ç çš„å¤ç”¨æ€§</h4><p>â›µ åœ¨ Vue2.x çš„æ—¶å€™ï¼Œé€šå¸¸é€šè¿‡ mixins åœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«é€»è¾‘ ä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºé™·å°±æ˜¯ mixins ä¹Ÿæ˜¯ç”±ä¸€å¤§å †çš„ Options ç»„æˆçš„ï¼Œå¹¶ä¸”å¤šä¸ª mixinss ä¼š<strong>å­˜åœ¨å‘½åå†²çª</strong>çš„é—®é¢˜ ğŸš€ åœ¨ Vue3.x ä¸­ï¼Œå¯ä»¥é€šè¿‡ Hook å‡½æ•°æ¥å°†ä¸€éƒ¨åˆ†ç‹¬ç«‹çš„é€»è¾‘æŠ½å–å‡ºå»ï¼Œå¹¶ä¸”å®ƒä»¬è¿˜<strong>å¯ä»¥åšåˆ°æ˜¯å“åº”å¼çš„</strong>ï¼Œé€šè¿‡æŒ‰éœ€å¯¼å…¥ï¼Œè¿™æ ·ä¸€ç›®äº†ç„¶ Hook å‡½æ•°æ¥è‡ªå“ªä¸ªæ–‡ä»¶</p></blockquote><blockquote><p><strong><code>data ä¸­è¿”å›çš„å¯¹è±¡ä¼šè¢« Vue çš„å“åº”å¼ç³»ç»ŸåŠ«æŒ(å“åº”å¼æ•°æ®)</code></strong>ï¼Œ<strong>ä¹‹åå¯¹è¯¥å¯¹è±¡çš„ä¿®æ”¹æˆ–è€…è®¿é—®éƒ½ä¼šåœ¨åŠ«æŒä¸­è¢«å¤„ç†</strong> æ‰€ä»¥åœ¨ template ä¸­é€šè¿‡  è®¿é—® data ä¸­çš„æ•°æ®ï¼Œå¯ä»å¯¹è±¡ä¸­è·å–åˆ°æ•°æ® æ‰€ä»¥ä¿®æ”¹ data çš„å€¼æ—¶ï¼Œtemplate ä¸­çš„  çš„å€¼ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜</p></blockquote><blockquote><p><strong>åœ¨ vue2 ä¸­æä¾› .sync ä¿®é¥°ç¬¦ï¼Œä½†æ˜¯åœ¨ vue3 ä¸­ä¸å†æ”¯æŒ.syncï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ v-model</strong></p><p>åœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸­çš„ v-modelï¼Œä¼šé»˜è®¤å±•å¼€æˆ<code>:modelValue</code>å’Œ<code>@update:modelValue</code>çš„å½¢å¼</p><div class="language-html ext-html line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-string-expression);">dialog</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">v-model</span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-string-expression);">&quot;dialogVisible&quot;</span><span style="color:var(--shiki-color-text);">&gt;&lt;/</span><span style="color:var(--shiki-token-string-expression);">dialog</span><span style="color:var(--shiki-color-text);">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-html ext-html line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-string-expression);">dialog</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-function);">:modelValue</span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-string-expression);">&quot;dialogVisible&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-function);">@update:modelValue</span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-token-string-expression);">&quot;newValue =&gt; dialogVisible = newValue&quot;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">&gt;&lt;/</span><span style="color:var(--shiki-token-string-expression);">dialog</span><span style="color:var(--shiki-color-text);">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å­ç»„ä»¶ä¸­<code>emit(&#39;update:modelValue&#39;, newValue)</code>ï¼Œçˆ¶ç»„ä»¶ç»‘å®šçš„å€¼å°±ä¼šéšä¹‹ä¿®æ”¹ã€‚</p><p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œv-model åœ¨ç»„ä»¶ä¸Šéƒ½æ˜¯ä½¿ç”¨ <code>modelValue</code> ä½œä¸º propï¼Œå¹¶ä»¥ <code>update:modelValue</code> ä½œä¸ºå¯¹åº”çš„äº‹ä»¶ã€‚é€šè¿‡ç»™ v-model æŒ‡å®šä¸€ä¸ªå‚æ•°æ¥æ›´æ”¹è¿™äº›åå­—ï¼š</strong></p><p><strong>v-model:è‡ªå®šä¹‰ prop = &#39;dialogVisible&#39;</strong></p></blockquote><h2 id="è¯»æºç " tabindex="-1"><a class="header-anchor" href="#è¯»æºç " aria-hidden="true">#</a> è¯»æºç </h2><p><strong><code>ç™»ä¸Š GitHub</code></strong> --- <strong><code>æœç´¢ä»£ç ä»“åº“</code></strong> --- <strong><code>æ‹‰å»ä»£ç åˆ†æ”¯(æ¨è master ç¨³å®šåˆ†æ”¯)</code></strong> --- <strong><code>å®‰è£…ä¾èµ–æŸ¥çœ‹ package.json æ–‡ä»¶</code></strong> --- <strong><code>å¯¹é¡¹ç›®è¿›è¡Œæ‰“åŒ…æˆ–å…¶å®ƒæ“ä½œ(å¦‚æœæ‰“åŒ…æˆ–è€…å…¶å®ƒæ“ä½œåä»£ç æ¶æ„ä¸æ¸…æ™°ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ --sourcemapï¼Œç±»ä¼¼ webpack çš„æºç æ˜ å°„é…ç½®ï¼Œæœ‰åˆ©äºè°ƒè¯•)</code></strong></p><p><strong>æ ¸å¿ƒéƒ¨åˆ†</strong></p><p><img src="/docs/img/image-20221103220601358.png" alt="image-20221103220601358" loading="lazy"></p><p><strong><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-dom\src\index.ts</code></strong> <strong>ä»è¿™å¼€å§‹ creatApp</strong></p><p><strong><code>D:\Material\Vueæºç è§£æ\core\packages\shared\src\index.ts</code></strong> <strong>Vue åœ¨è¿™é‡Œå¯¼å‡ºå·¥å…·æ–¹æ³•</strong></p><h3 id="options-api" tabindex="-1"><a class="header-anchor" href="#options-api" aria-hidden="true">#</a> options Api</h3><blockquote><h3 id="methods-ä¸­çš„æ–¹æ³•-this-æŒ‡å‘" tabindex="-1"><a class="header-anchor" href="#methods-ä¸­çš„æ–¹æ³•-this-æŒ‡å‘" aria-hidden="true">#</a> Methods ä¸­çš„æ–¹æ³• this æŒ‡å‘</h3><p>ä¸èƒ½ä½¿ç”¨ <strong>ç®­å¤´å‡½æ•°</strong> å®šä¹‰ methods ä¸­çš„æ–¹æ³•( this æŒ‡å‘é—®é¢˜ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰ thisï¼Œæ‰€ä»¥å®ƒåœ¨å®šä¹‰æ—¶å€™å°±ç¡®å®š this çš„å€¼ )</p><p><strong>æºç è§£è¯»</strong>ğŸŸ</p><p><strong>åœ¨ Methods ä¸­å–å‡ºå‡½æ•°ï¼Œé€šè¿‡ bind() æ–¹æ³•ï¼Œæ˜¾ç¤ºçš„æ”¹å˜å®ƒçš„ this æŒ‡å‘ publicThis å¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå°†è¿”å›çš„å‡½æ•°èµ‹å€¼åˆ°ä¸Šä¸‹æ–‡ ctx å¯¹è±¡ä»¥æºå‡½æ•°åŒåçš„ key å±æ€§ ä¸­ï¼Œã€å®é™…ä¸Šåœ¨ä»£ç ä¸­è°ƒç”¨çš„å¹¶ä¸æ˜¯æºå‡½æ•°ï¼Œè€Œæ˜¯é€šè¿‡å¤„ç†åçš„ <code>ctx[&#39;å‡½æ•°å&#39;]</code>ã€‘</strong></p><p><strong><code>publicThis</code></strong>ï¼š<strong>ç»„ä»¶å®ä¾‹çš„ä»£ç† ï¼Œ<code>const publicThis = instance.proxy</code></strong></p><p><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-core\src\componentOptions.ts:625 </code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (methods) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">key</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">in</span><span style="color:var(--shiki-color-text);"> methods) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">methodHandler</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (methods </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">MethodOptions</span><span style="color:var(--shiki-color-text);">)[key]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(methodHandler)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-comment);">// åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨`createRenderContext`å‡½æ•°æ¥å®šä¹‰</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-comment);">// ä»£ç†ç›®æ ‡çš„æ–¹æ³•ï¼Œé‚£äº›æ˜¯åªè¯»çš„ä½†æ˜¯</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-comment);">// å¯é‡æ–°é…ç½®ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦é‡æ–°å®šä¹‰</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       </span><span style="color:var(--shiki-token-constant);">Object</span><span style="color:var(--shiki-token-function);">.defineProperty</span><span style="color:var(--shiki-color-text);">(ctx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> key</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         value</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">methodHandler</span><span style="color:var(--shiki-token-function);">.bind</span><span style="color:var(--shiki-color-text);">(publicThis)</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         configurable</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         enumerable</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         writable</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       ctx[key] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">methodHandler</span><span style="color:var(--shiki-token-function);">.bind</span><span style="color:var(--shiki-color-text);">(publicThis)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       </span><span style="color:var(--shiki-token-function);">checkDuplicateProperties</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">OptionTypes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">METHODS</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> key)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       </span><span style="color:var(--shiki-token-string-expression);">`Method &quot;</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-color-text);">key</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">&quot; has type &quot;</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-token-keyword);">typeof</span><span style="color:var(--shiki-color-text);"> methodHandler</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">&quot; in the component definition. `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         </span><span style="color:var(--shiki-token-string-expression);">`Did you reference the function correctly?`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="computed-ç®€å†™-ä¸-å®Œæ•´å†™æ³•çš„å¤„ç†" tabindex="-1"><a class="header-anchor" href="#computed-ç®€å†™-ä¸-å®Œæ•´å†™æ³•çš„å¤„ç†" aria-hidden="true">#</a> computed ç®€å†™ ä¸ å®Œæ•´å†™æ³•çš„å¤„ç†</h3><p><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-core\src\componentOptions.ts:694 </code></p><p><strong>ğŸ«• åŒæ ·ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (computedOptions) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">key</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">in</span><span style="color:var(--shiki-color-text);"> computedOptions) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (computedOptions </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComputedOptions</span><span style="color:var(--shiki-color-text);">)[key]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// è·å– getter æ–¹æ³•</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">get</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(opt) </span><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­æ˜¯å¦ä¸ºç®€å†™ Function å†™æ³•</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-token-function);">.bind</span><span style="color:var(--shiki-color-text);">(publicThis</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> publicThis) </span><span style="color:var(--shiki-token-comment);">// ä¿®æ”¹ this ç»‘å®š proxy(åŒMethodså¤„ç†)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-color-text);">.get)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-token-function);">.</span><span style="color:var(--shiki-token-constant);">get</span><span style="color:var(--shiki-token-function);">.bind</span><span style="color:var(--shiki-color-text);">(publicThis</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> publicThis)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">NOOP</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// NOOP = () =&gt; {}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> get </span><span style="color:var(--shiki-token-keyword);">===</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">NOOP</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">`Computed property &quot;</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-color-text);">key</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">&quot; has no getter.`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// è·å– setter æ–¹æ³•</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">set</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(opt) </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-color-text);">.set)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">opt</span><span style="color:var(--shiki-token-function);">.</span><span style="color:var(--shiki-token-constant);">set</span><span style="color:var(--shiki-token-function);">.bind</span><span style="color:var(--shiki-color-text);">(publicThis)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> __DEV__</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                </span><span style="color:var(--shiki-token-string-expression);">`Write operation failed: computed property &quot;</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-color-text);">key</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">&quot; is readonly.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">NOOP</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// ï¼Ÿï¼Ÿï¼Ÿcompostion API</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">computed</span><span style="color:var(--shiki-color-text);">({</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        get</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        set</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-constant);">Object</span><span style="color:var(--shiki-token-function);">.defineProperty</span><span style="color:var(--shiki-color-text);">(ctx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> key</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        enumerable</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        configurable</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">get</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c</span><span style="color:var(--shiki-color-text);">.value</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// vue3 å“åº”å¼å†™æ³•</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">set</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> v </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">c</span><span style="color:var(--shiki-color-text);">.value </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> v)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// æ£€æŸ¥é‡å¤å±æ€§</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">checkDuplicateProperties</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">OptionTypes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">COMPUTED</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> key)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="watch-ç›‘å¬å™¨" tabindex="-1"><a class="header-anchor" href="#watch-ç›‘å¬å™¨" aria-hidden="true">#</a> watch ç›‘å¬å™¨</h3><p><strong><code>æ³¨æ„ï¼šwatch ç›‘å¬ä¸åˆ° å¼•ç”¨ç±»å‹ çš„æ—§å€¼(oldValue)</code></strong></p><p><strong>å…¶å®ƒå†™æ³•(å­—ç¬¦ä¸²)</strong>ï¼š<strong><code>ç›‘å¬å±æ€§:&#39;methodsæ–¹æ³•å&#39;</code></strong>;</p><p><strong>æ•°ç»„ï¼š</strong> <strong><code>[&#39;å­—ç¬¦ä¸²å†™æ³•&#39; , Functionå†™æ³• , Objectå†™æ³•]ï¼Œé€ä¸€è¢«è°ƒç”¨</code></strong></p><p><strong>å¯¹è±¡å±æ€§ç®€å†™ï¼š</strong> <strong><code>&#39;å¯¹è±¡.å±æ€§&#39;(){}</code></strong></p></blockquote><blockquote><h3 id="ä¾èµ–æ³¨å…¥-provide-inject" tabindex="-1"><a class="header-anchor" href="#ä¾èµ–æ³¨å…¥-provide-inject" aria-hidden="true">#</a> ä¾èµ–æ³¨å…¥ provide inject</h3><p><strong>å¦‚æœéœ€è¦è¿”å› data ä¸­çš„æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨ Function å†™æ³•ï¼Œä½†æ˜¯æ•°æ®ä¸ä¼šæ˜¯å“åº”å¼çš„ï¼Œè§£å†³æ–¹æ¡ˆï¼š</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">import</span><span style="color:var(--shiki-color-text);"> { computed } </span><span style="color:var(--shiki-token-keyword);">from</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;vue&#39;</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">provide</span><span style="color:var(--shiki-color-text);">(){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-color-text);">.name</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// ä¸æ˜¯å“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// è½¬åŒ–å“åº”å¼æ•°æ®</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-token-function);">computed</span><span style="color:var(--shiki-color-text);">(() </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-color-text);">.name)</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// Vue3 compostion API</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="composition-api-1" tabindex="-1"><a class="header-anchor" href="#composition-api-1" aria-hidden="true">#</a> composition Api</h3><blockquote><h3 id="ğŸª‚-setup" tabindex="-1"><a class="header-anchor" href="#ğŸª‚-setup" aria-hidden="true">#</a> ğŸª‚ setup</h3><p><strong>åœ¨ setup ä¸­åº”å½“é¿å…ä½¿ç”¨ thisï¼Œå› ä¸ºå®ƒä¸ä¼šæ‰¾åˆ°ç»„ä»¶å®ä¾‹ã€‚<code>setup çš„è°ƒç”¨å‘ç”Ÿåœ¨ data propertyã€computed property æˆ– methods è¢«è§£æŠ˜ä¹‹å‰ï¼Œè°ƒç”¨ createComponentInstance åˆ›å»ºç»„ä»¶å®ä¾‹ä¹‹å</code>ï¼Œæ‰€ä»¥å®ƒä»¬æ— æ³•åœ¨ setup ä¸­è·å–</strong></p><p><strong>åœ¨é˜…è¯»æºç çš„è¿‡ç¨‹ä¸­ï¼Œä»£ç æ˜¯æŒ‰ç…§å¦‚ä¸‹é¡ºåºæ‰§è¡Œçš„</strong> &gt; <strong>ğŸŸ è°ƒç”¨ createComponentInstance åˆ›å»ºç»„ä»¶å®ä¾‹</strong> &gt; <strong>ğŸ³ è°ƒç”¨ setupComponent åˆå§‹åŒ– component å†…éƒ¨çš„æ“ä½œ</strong> &gt; <strong>ğŸƒ è°ƒç”¨ setupStatefulComponent åˆå§‹åŒ–æœ‰çŠ¶æ€çš„ç»„ä»¶</strong> &gt; <strong>ğŸŒ åœ¨ setupStatefulComponent å–å‡º setup å‡½æ•°</strong> &gt; <strong>ğŸ›µ é€šè¿‡ callWithErrorHandling çš„å‡½æ•°æ‰§è¡Œ setup</strong></p><p>å¤„ç†ç»„ä»¶åœ¨ï¼š <strong><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-core\src\renderer.tsï¼š421</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// ...å¤„ç†ç»„ä»¶èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (shapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">COMPONENT</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">processComponent</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         n1</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">         optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">processComponent</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> n1</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> n2</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> container</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererElement</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> anchor</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererNode</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">SuspenseBoundary</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> isSVG</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> slotScopeIds</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">string</span><span style="color:var(--shiki-color-text);">[] </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> optimized</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n2</span><span style="color:var(--shiki-color-text);">.slotScopeIds </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> slotScopeIds</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// n1 == null è¡¨ç¤ºè¿™æ˜¯æŒ‚è½½èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (n1 </span><span style="color:var(--shiki-token-keyword);">==</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">n2</span><span style="color:var(--shiki-color-text);">.shapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">COMPONENT_KEPT_ALIVE</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     ;(parentComponent</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-color-text);">.ctx </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">KeepAliveContext</span><span style="color:var(--shiki-color-text);">)</span><span style="color:var(--shiki-token-function);">.activate</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-comment);">// è°ƒç”¨ mountComponent æŒ‚è½½ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">mountComponent</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">       optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// n1 ä¸ºéç©ºè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ›´æ–°ï¼Œæ›´æ–°ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">updateComponent</span><span style="color:var(--shiki-color-text);">(n1</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> n2</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> optimized)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ğŸŸ è°ƒç”¨ createComponentInstance åˆ›å»ºç»„ä»¶å®ä¾‹</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">mountComponent</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">MountComponentFn</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> initialVNode</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// 2.x compat å¯ä»¥åœ¨å®é™…ä¹‹å‰é¢„å…ˆåˆ›å»ºç»„ä»¶å®ä¾‹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// å®‰è£…,è°ƒç”¨ createComponentInstance åˆ›å»ºç»„ä»¶å®ä¾‹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">compatMountInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   __COMPAT__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">initialVNode</span><span style="color:var(--shiki-color-text);">.isCompatRoot </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">initialVNode</span><span style="color:var(--shiki-color-text);">.component</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   compatMountInstance </span><span style="color:var(--shiki-token-keyword);">||</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   (</span><span style="color:var(--shiki-token-constant);">initialVNode</span><span style="color:var(--shiki-color-text);">.component </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">createComponentInstance</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     initialVNode</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     parentSuspense</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   ))</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">type</span><span style="color:var(--shiki-color-text);">.__hmrId) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">registerHMR</span><span style="color:var(--shiki-color-text);">(instance)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">pushWarningContext</span><span style="color:var(--shiki-color-text);">(initialVNode)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">startMeasure</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">`mount`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// inject renderer internals for keepAlive</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isKeepAlive</span><span style="color:var(--shiki-color-text);">(initialVNode)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   ;(</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.ctx </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">KeepAliveContext</span><span style="color:var(--shiki-color-text);">).renderer </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> internals</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// è§£æè®¾ç½®ä¸Šä¸‹æ–‡çš„é“å…·å’Œæ’æ§½</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// ä½œç”¨æ˜¯å¯¹ç»„ä»¶çš„ props å’Œ slots ç­‰è¿›è¡Œåˆå§‹åŒ–å¤„ç†(å¹¶ä¸”å†…éƒ¨æœ‰å¯¹ Vue2.x çš„ options Api å…¼å®¹å¤„ç†)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-color-text);">(__COMPAT__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> compatMountInstance)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">startMeasure</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">`init`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-comment);">// ğŸ³ è°ƒç”¨ setupComponent åˆå§‹åŒ– component å†…éƒ¨çš„æ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">setupComponent</span><span style="color:var(--shiki-color-text);">(instance)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">endMeasure</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">`init`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// setup() is async. This component relies on async logic to be resolved</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// before proceeding</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__FEATURE_SUSPENSE__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.asyncDep) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   parentSuspense </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">parentSuspense</span><span style="color:var(--shiki-token-function);">.registerDep</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> setupRenderEffect)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-comment);">// Give it a placeholder if this is not hydration</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-comment);">// TODO handle self-defined fallback</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-token-constant);">initialVNode</span><span style="color:var(--shiki-color-text);">.el) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">placeholder</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.subTree </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">createVNode</span><span style="color:var(--shiki-color-text);">(Comment))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">     </span><span style="color:var(--shiki-token-function);">processCommentNode</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> placeholder</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> container</span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> anchor)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-keyword);">return</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">setupRenderEffect</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   instance</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   initialVNode</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> )</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">popWarningContext</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">   </span><span style="color:var(--shiki-token-function);">endMeasure</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">`mount`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);"> }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-core\src\component.tsï¼š596</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// ğŸ³ è°ƒç”¨ setupComponent åˆå§‹åŒ– component å†…éƒ¨çš„æ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">export</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">setupComponent</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">instance</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">isSSR </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">isInSSRComponentSetup </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> isSSR</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">props</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">children</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.vnode</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­æ˜¯å¦æ˜¯æœ‰çŠ¶æ€ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">isStateful</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isStatefulComponent</span><span style="color:var(--shiki-color-text);">(instance)</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// åˆå§‹åŒ– props å’Œ slots</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">initProps</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> props</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isStateful</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isSSR)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">initSlots</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> children)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ğŸƒ è°ƒç”¨ setupStatefulComponent åˆå§‹åŒ–æœ‰çŠ¶æ€çš„ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">/**</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">   * è®¾ç½®æœ‰çŠ¶æ€</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">   * </span><span style="color:var(--shiki-token-keyword);">@param</span><span style="color:var(--shiki-token-comment);"> </span><span style="color:var(--shiki-token-function);">{object}</span><span style="color:var(--shiki-token-comment);"> ã€å¯¹è±¡ã€‘ç»„ä»¶ - æœ‰çŠ¶æ€ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">   * </span><span style="color:var(--shiki-token-keyword);">@param</span><span style="color:var(--shiki-token-comment);"> </span><span style="color:var(--shiki-token-function);">{fuction}</span><span style="color:var(--shiki-token-comment);"> ã€å‡½æ•°ã€‘ç»„ä»¶ - æ— çŠ¶æ€ç»„ä»¶</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">  */</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">setupResult</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> isStateful</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">setupStatefulComponent</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isSSR) </span><span style="color:var(--shiki-token-comment);">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">undefined</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  isInSSRComponentSetup </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> setupResult</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ğŸŒ åœ¨setupStatefulComponent å–å‡º setup å‡½æ•°</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">setupStatefulComponent</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  instance</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  isSSR</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.type </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentOptions</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.name) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">validateComponentName</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.name</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">appContext</span><span style="color:var(--shiki-color-text);">.config)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.components) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">names</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Object</span><span style="color:var(--shiki-token-function);">.keys</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.components)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">; i </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">names</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);">; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">validateComponentName</span><span style="color:var(--shiki-color-text);">(names[i]</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">appContext</span><span style="color:var(--shiki-color-text);">.config)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.directives) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">names</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Object</span><span style="color:var(--shiki-token-function);">.keys</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.directives)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">; i </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">names</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);">; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">validateDirectiveName</span><span style="color:var(--shiki-color-text);">(names[i])</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.compilerOptions </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isRuntimeOnly</span><span style="color:var(--shiki-color-text);">()) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`&quot;compilerOptions&quot; is only supported when using a build of Vue that `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-string-expression);">`includes the runtime compiler. Since you are using a runtime-only `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-string-expression);">`build, the options should be passed via your build tool config instead.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// 0. åˆ›å»ºæ¸²æŸ“ä»£ç†å±æ€§è®¿é—®ç¼“å­˜</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.accessCache </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Object</span><span style="color:var(--shiki-token-function);">.create</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// 1. åˆ›å»ºå…¬å…±å®ä¾‹/æ¸²æŸ“ä»£ç†</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// ä¹Ÿå°†å…¶æ ‡è®°ä¸ºåŸå§‹çš„ï¼Œå› æ­¤ä»æœªè§‚å¯Ÿâ€‹â€‹åˆ°</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.proxy </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">markRaw</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-keyword);">new</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Proxy</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.ctx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> PublicInstanceProxyHandlers))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">exposePropsOnRenderContext</span><span style="color:var(--shiki-color-text);">(instance)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// 2. call setup() è°ƒç”¨ setup()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">setup</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> Component</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (setup) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// sutup æœ‰å‚æ•° åˆ›å»º setup ä¸Šä¸‹æ–‡, å¹¶ä¸”å°† setup ä¸Šä¸‹æ–‡æŒ‚è½½åˆ°å®ä¾‹ä¸Š setupContext = { attrs, slots, emit }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">setupContext</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.setupContext </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-constant);">setup</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">createSetupContext</span><span style="color:var(--shiki-color-text);">(instance) </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">setCurrentInstance</span><span style="color:var(--shiki-color-text);">(instance)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">pauseTracking</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// ğŸ›µ é€šè¿‡ callWithErrorHandling çš„å‡½æ•°æ‰§è¡Œ setup</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// æ‰§è¡Œ setup å‡½æ•°å¹¶ä¸”å°†è¿”å›å€¼èµ‹å€¼ç»™ setupResult(è·å–ç»“æœ)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// å†…éƒ¨ä¼šæ‰§è¡Œ setup å‡½æ•°å¹¶ä¸”å°†instance(prop)ã€setupContext ä½œä¸ºå‚æ•°ä¼ å…¥</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// ä¸ºä»€ä¹ˆä¸ç›´æ¥æ‰§è¡Œ,é€šè¿‡callWithErrorHandlingå°è£…ä¸€äº›æ•è·é”™è¯¯çš„æ–¹æ³• try...catch</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">setupResult</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">callWithErrorHandling</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      setup</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      instance</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-constant);">ErrorCodes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">SETUP_FUNCTION</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      [__DEV__ </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">shallowReadonly</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.props) </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.props</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> setupContext] </span><span style="color:var(--shiki-token-comment);">// ä¼ é€’ prop setupContext,å›è°ƒsetup(...args)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">resetTracking</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">unsetCurrentInstance</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isPromise</span><span style="color:var(--shiki-color-text);">(setupResult)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-constant);">setupResult</span><span style="color:var(--shiki-token-function);">.then</span><span style="color:var(--shiki-color-text);">(unsetCurrentInstance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> unsetCurrentInstance)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (isSSR) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// return the promise so server-renderer can wait on it</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> setupResult</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">.then</span><span style="color:var(--shiki-color-text);">((resolvedResult</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">unknown</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-function);">handleSetupResult</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> resolvedResult</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isSSR)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">.catch</span><span style="color:var(--shiki-color-text);">(e </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-function);">handleError</span><span style="color:var(--shiki-color-text);">(e</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ErrorCodes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">SETUP_FUNCTION</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__FEATURE_SUSPENSE__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// async setup returned Promise.</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// bail here and wait for re-entry.</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.asyncDep </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> setupResult</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.suspense) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">name</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Component</span><span style="color:var(--shiki-color-text);">.name </span><span style="color:var(--shiki-token-keyword);">??</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;Anonymous&#39;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-string-expression);">`Component &lt;</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-color-text);">name</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">&gt;: setup function returned a promise, but no `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-string-expression);">`&lt;Suspense&gt; boundary was found in the parent component tree. `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-string-expression);">`A component with async setup() must be nested in a &lt;Suspense&gt; `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-string-expression);">`in order to be rendered.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-string-expression);">`setup() returned a Promise, but the version of Vue you are using `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-string-expression);">`does not support it yet.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">handleSetupResult</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> setupResult</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isSSR)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">finishComponentSetup</span><span style="color:var(--shiki-color-text);">(instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> isSSR)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// callWithErrorHandling å‡½æ•°å¸®åŠ©æ‰§è¡Œ steup å‡½æ•°ï¼Œæ•è·é”™è¯¯</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">export</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">callWithErrorHandling</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-function);">fn</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">Function</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  instance</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  type</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ErrorTypes</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  args</span><span style="color:var(--shiki-token-keyword);">?:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">unknown</span><span style="color:var(--shiki-color-text);">[]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> res</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">try</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ setup ä½¿ç”¨ thisï¼Ÿè¿™é‡Œæ²¡æœ‰å¯¹å‡½æ•° setup è¿›è¡Œ this ç»‘å®š</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    res </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> args </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">fn</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-keyword);">...</span><span style="color:var(--shiki-color-text);">args) </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">fn</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">catch</span><span style="color:var(--shiki-color-text);"> (err) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">handleError</span><span style="color:var(--shiki-color-text);">(err</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> type)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> res</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h4 id="å°ä¹ æƒ¯" tabindex="-1"><a class="header-anchor" href="#å°ä¹ æƒ¯" aria-hidden="true">#</a> å°ä¹ æƒ¯ï¼š</h4><p>å½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œä»…ä»…éœ€è¦è·å–å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„ä½¿ç”¨ï¼Œä¸éœ€è¦ç¬¬ä¸€ä¸ªå‚æ•°æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ <code>_</code>è¿›è¡Œå ä½</p><p><code>setup ( _ , context )</code></p></blockquote><blockquote><h3 id="ğŸŸ-reactive-å“åº”å¼" tabindex="-1"><a class="header-anchor" href="#ğŸŸ-reactive-å“åº”å¼" aria-hidden="true">#</a> ğŸŸ reactive å“åº”å¼</h3><p><strong>reactive å½“ä¼ å…¥åŸºç¡€æ•°æ®ç±»å‹ä¼šäº§ç”Ÿæ§åˆ¶å°è­¦å‘Šï¼Œæ­£ç¡®åº”å½“ä½¿ç”¨ å¯¹è±¡æˆ–è€…æ•°ç»„</strong></p><p><strong>options Api çš„å“åº”å¼å¤„ç†ä¹Ÿæ—¶é€šè¿‡ composition Api è¿›è¡ŒåŒ…è£¹å¤„ç†çš„</strong>ï¼Œ<strong><code>reactive({ ...åŒ…è£¹ options Api å“åº”å¼æ•°æ® })</code></strong></p><p><strong><code>é€šè¿‡ä½¿ç”¨ reactive å¤„ç†åçš„è¿”å›å€¼ï¼Œå½“è¯»å–æ—¶ï¼Œä¼šåšä¸€ä¸ªæ•°æ®åŠ«æŒ(Proxy åšæ•°æ®åŠ«æŒ[getterã€setter])</code></strong></p><p><strong><code>å“åº”å¼æ•°æ®è¢«ä½¿ç”¨çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä¾èµ–çš„æ”¶é›†(æ¨¡æ¿ä¸Šçš„æ•°æ®ä½¿ç”¨...ç­‰ç­‰)ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå¯¹ç›¸åº”æ”¶é›†çš„ä¾èµ–è¿›è¡Œå¯¹åº”çš„å“åº”å¼æ›´æ–°æ“ä½œ</code></strong></p></blockquote><blockquote><h3 id="ğŸ³-ref-å“åº”å¼-å®˜æ–¹-æ¨èå°½é‡ä½¿ç”¨-ref-è€Œä¸æ˜¯-reactive" tabindex="-1"><a class="header-anchor" href="#ğŸ³-ref-å“åº”å¼-å®˜æ–¹-æ¨èå°½é‡ä½¿ç”¨-ref-è€Œä¸æ˜¯-reactive" aria-hidden="true">#</a> ğŸ³ ref å“åº”å¼(å®˜æ–¹ï¼šæ¨èå°½é‡ä½¿ç”¨ ref è€Œä¸æ˜¯ reactive)</h3><p><strong>ref ä¼šè¿”å›ä¸€ä¸ª<code>å¯å˜çš„å“åº”å¼å¯¹è±¡</code>ï¼Œè¯¥å¯¹è±¡<code>ä½œä¸ºä¸€ä¸ªã€å“å¼çš„å¼•ç”¨ã€‘ç»´æŠ¤ç€å®ƒã€å†…éƒ¨çš„å€¼ã€‘</code>ï¼Œè¿™å°±æ˜¯ ref åç§°çš„æ¥æºï¼›</strong> &gt; <strong>å®ƒå†…éƒ¨çš„å€¼æ˜¯åœ¨ ref çš„ value å±æ€§ä¸­è¢«ç»´æŠ¤çš„ï¼ŒçœŸæ­£çš„æ•°æ®æ˜¯åœ¨ value ä¸­ç»´æŠ¤ï¼›</strong></p><p><strong>åœ¨<code>æ¨¡æ¿</code>ä¸­ä½¿ç”¨ ref æ•°æ®ï¼Œç†è®ºæ¥è¯´åº”å½“æ˜¯ä¸€ä¸ª å¯å˜çš„ ref å“åº”å¼å¯¹è±¡ï¼ŒVue ä¸ºäº†å¼€å‘æ–¹ä¾¿ï¼Œåœ¨æ¨¡æ¿ä½¿ç”¨ ref å¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œè§£åŒ…ï¼Œä¸éœ€è¦ <code>ref.value</code></strong>ï¼›</p><p><strong>æ³¨æ„ï¼šåœ¨é€»è¾‘ä»£ç ä¸­å¹¶æ²¡æœ‰è‡ªåŠ¨è¿›è¡Œè§£åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Vue çš„æ–°å®éªŒæ€§åŠŸèƒ½å¯¹é€»è¾‘ä»£ç è¿›è¡Œè§£åŒ… -&gt; <a href="https://github.com/vuejs/core/tree/main/packages/reactivity-transform" target="_blank" rel="noopener noreferrer">Vue çš„å“åº”æ€§è¯­æ³•ç³–<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></strong></p><h4 id="ref-è§£åŒ…" tabindex="-1"><a class="header-anchor" href="#ref-è§£åŒ…" aria-hidden="true">#</a> ref è§£åŒ…ï¼š</h4><p><strong>ref çš„è§£åŒ…æ“ä½œæ˜¯ä¸€ä¸ª<code>æµ…å±‚çš„è§£åŒ…</code>ï¼Œå½“åœ¨æ¨¡æ¿ä¸­ç›´æ¥è¯»å– ref å¯¹è±¡æ—¶æ‰ä¼šè¿›è¡Œè§£åŒ…æ“ä½œï¼Œä½†æ˜¯<code>é€šè¿‡å°† ref å¯¹è±¡ç›´æ¥èµ‹å€¼ç»™ä¸€ä¸ªæ™®é€šå¯¹è±¡å±æ€§æ—¶ï¼Œåœ¨æ¨¡æ¿ä¸­é€šè¿‡ å¯¹è±¡.ref å¯¹è±¡ æ—¶æ˜¯ä¸ä¼šè¿›è¡Œè§£åŒ…çš„</code></strong>ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡åŒ…è£¹çš„ ref å¯¹è±¡ååœ¨æ¨¡æ¿ä¸­ä¸èƒ½è¿›è¡Œè§£åŒ…äº†</p><p><strong>ä¸èƒ½è§£åŒ…æƒ…å†µã€æ™®é€šå¯¹è±¡åŒ…è£¹ã€‘ï¼Œèƒ½è§£åŒ…æƒ…å†µã€reactive å¯¹è±¡åŒ…è£¹ã€‘</strong></p></blockquote><blockquote><h3 id="ğŸƒ-readonly-åªè¯»" tabindex="-1"><a class="header-anchor" href="#ğŸƒ-readonly-åªè¯»" aria-hidden="true">#</a> ğŸƒ readonly åªè¯»</h3><p><strong>readonly ä¼š<code>è¿”å›åŸç”Ÿå¯¹è±¡çš„åªè¯»ä»£ç†</code>ï¼ˆä¹Ÿå°±æ˜¯å®ƒä¾ç„¶æ˜¯ä¸€ä¸ª Proxy ï¼Œè¿™ä¸ª Proxy çš„ <code>set æ–¹æ³•è¢«åŠ«æŒ</code>ï¼Œå¹¶ä¸”ä¸èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹)ã€åœ¨ setter æ–¹æ³•é‡Œå¯¹æ•°æ®ä¿®æ”¹è¿›è¡Œé™åˆ¶ã€‘</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// æºå¯¹è±¡(æ™®é€šå¯¹è±¡)</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">info</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">};</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// å¤„ç†åè¿”å›çš„å¯¹è±¡</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">info_</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">readonly</span><span style="color:var(--shiki-color-text);">(info);</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// æ³¨æ„ï¼šæºå¯¹è±¡å¯ä»¥è¢«ä¿®æ”¹ï¼Œä¿®æ”¹æºå¯¹è±¡æ•°æ®ä¸ä¼šæ›´æ–°ğŸƒ</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">reactive;</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">info_</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">readonly</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	info </span><span style="color:var(--shiki-token-comment);">/* reactive å¤„ç†åçš„å¯¹è±¡åœ¨è¿›è¡Œ readonlyï¼Œä¸å¯ä»¥è¢«ä¿®æ”¹ */</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// æ³¨æ„ï¼šreactive æºå¯¹è±¡å¯ä»¥è¢«ä¿®æ”¹ï¼Œè¢«ä¿®æ”¹ï¼Œreadonly å¯¹è±¡æ•°æ®ä¼šæ›´æ–°(å› ä¸ºæ˜¯å“åº”å¼çš„)ğŸƒ</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">ref;</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">info_</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">readonly</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	info </span><span style="color:var(--shiki-token-comment);">/* ref å¤„ç†åçš„å¯¹è±¡åœ¨è¿›è¡Œ readonlyï¼Œä¸å¯ä»¥è¢«ä¿®æ”¹ */</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// æ³¨æ„ï¼šref æºå¯¹è±¡å¯ä»¥è¢«ä¿®æ”¹ï¼Œè¢«ä¿®æ”¹ï¼Œreadonly å¯¹è±¡æ•°æ®ä¼šæ›´æ–°(å› ä¸ºæ˜¯å“åº”å¼çš„)ğŸƒ</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸš€-reactive-åˆ¤æ–­-api" tabindex="-1"><a class="header-anchor" href="#ğŸš€-reactive-åˆ¤æ–­-api" aria-hidden="true">#</a> ğŸš€ Reactive åˆ¤æ–­ Api</h3><p><strong><code>isProxy</code>ï¼šæ£€æŸ¥å¯¹è±¡æ˜¯å¦ç”± reactive æˆ–è€… readonly åˆ›å»ºçš„ Proxy ä»£ç†</strong></p><p><strong><code>isReactive</code>ï¼šæ£€æŸ¥å¯¹è±¡æ˜¯å¦ç”± reactive åˆ›å»ºçš„å“åº”å¼ä»£ç†ã€æ³¨æ„ï¼šå¦‚æœè¯¥ä»£ç†æ˜¯ç”± readonly åˆ›å»ºçš„ï¼Œä½†æ˜¯åŒ…è£¹çš„æ˜¯ reactive åˆ›å»ºçš„å¦å¤–ä¸€ä¸ªä»£ç†ï¼ŒåŒæ ·è¿”å› trueã€‘</strong></p><p><strong><code>isReadonly </code>ï¼šæ£€æŸ¥å¯¹è±¡æ˜¯å¦ç”± readonly åˆ›å»ºçš„ Proxy åªè¯»ä»£ç†</strong></p><p><strong><code>toRaw</code>ï¼šè¿”å› reactive or readonly ä»£ç†çš„åŸå§‹å¯¹è±¡</strong></p><p><strong><code>shallowReactive</code>ï¼šåˆ›å»ºæµ…å±‚æ¬¡çš„ Proxy ä»£ç†ã€åªå¯¹ç¬¬ä¸€å±‚ property å±æ€§è¿›è¡Œä»£ç†ï¼Œä¸æ‰§è¡Œæ·±å±‚æ¬¡çš„åµŒå¥—å¯¹è±¡ä»£ç†ï¼Œæ·±å±‚æ¬¡çš„å¯¹è±¡è¿˜æ˜¯åŸå§‹çš„å¯¹è±¡ã€‘</strong></p><p><strong><code>shallowReadonly</code>ï¼šä½œç”¨åŒä¸Š</strong></p></blockquote><blockquote><h3 id="ğŸ›µ-torefs-api" tabindex="-1"><a class="header-anchor" href="#ğŸ›µ-torefs-api" aria-hidden="true">#</a> ğŸ›µ toRefs Api</h3><p><strong>å¯¹ reactive <code>æ‰€æœ‰å±æ€§è¿›è¡Œè½¬åŒ– ref å¯¹è±¡</code>ï¼Œå‚æ•°å¿…é¡»æ˜¯å“åº”å¼å¯¹è±¡</strong></p><p><strong>é€šè¿‡ refs è§£æ„è¿”å› name ref å¯¹è±¡ï¼Œ<code>åœ¨ reactive çš„å±æ€§ä¸ ref.value å±æ€§å»ºç«‹é“¾æ¥ğŸª‚</code>ï¼Œä»»ä½•ä¸€æ–¹ä¿®æ”¹ï¼Œéƒ½ä¼šå¼•èµ·å¦å¤–ä¸€æ–¹å˜åŒ–</strong></p><p><strong>å¯¹ reactive è¿›è¡Œå¯¹è±¡è§£æ„ä¸ºä»€ä¹ˆä¼šä¸¢å¤±å“åº”å¼ï¼Ÿ</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">name</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">reactive</span><span style="color:var(--shiki-color-text);">({ name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ç›¸å½“äº</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> name </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);">; </span><span style="color:var(--shiki-token-comment);">// ç›´æ¥èµ‹å€¼æ•°æ®(åŸºç¡€æ•°æ®ğŸ›°ï¸)ï¼Œä¸¢å¤±å“åº”å¼</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸœï¸-toref-api" tabindex="-1"><a class="header-anchor" href="#ğŸœï¸-toref-api" aria-hidden="true">#</a> ğŸœï¸ toRef Api</h3><p><strong>å¯¹ä¸€ä¸ªå±æ€§è¿›è¡Œ ref å¯¹è±¡è½¬åŒ–ï¼Œ<code>åŒºåˆ«äº toRefs å‡å°‘æ€§èƒ½å¼€é”€ï¼Œæ²¡æœ‰è§£æ„èµ‹å€¼ï¼Œå› ä¸ºåªè¿”å›ä¸€ä¸ªå€¼</code>ï¼Œå‚æ•°å¿…é¡»æ˜¯å“åº”å¼å¯¹è±¡</strong></p></blockquote><blockquote><h3 id="ğŸ™ï¸-unref-api" tabindex="-1"><a class="header-anchor" href="#ğŸ™ï¸-unref-api" aria-hidden="true">#</a> ğŸ™ï¸ unref Api</h3><p><strong>è·å–ä¸€ä¸ª ref å¯¹è±¡å¼•ç”¨ä¸­çš„ value å€¼ã€è§£åŒ…ã€‘ï¼Œä¸€ä¸ªè¯­æ³•ç³–</strong></p><p><strong><code>val = isRef(val)? val.value : value</code></strong></p></blockquote><blockquote><h3 id="ğŸ‰-isref-api" tabindex="-1"><a class="header-anchor" href="#ğŸ‰-isref-api" aria-hidden="true">#</a> ğŸ‰ isRef Api</h3><p><strong>åŒä¸Š isReactive</strong></p></blockquote><blockquote><h3 id="ğŸª…-shallowref-api" tabindex="-1"><a class="header-anchor" href="#ğŸª…-shallowref-api" aria-hidden="true">#</a> ğŸª… shallowRef Api</h3><p><strong>æµ…å±‚çš„ ref å¯¹è±¡</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ref</span><span style="color:var(--shiki-color-text);">({ name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ä¿®æ”¹ valï¼Œæ·±å±‚æ¬¡çš„ä¿®æ”¹(ç›´æ¥é€šè¿‡ .name ä¿®æ”¹)ï¼Œè¿˜æ˜¯å“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">value</span><span style="color:var(--shiki-color-text);">.name </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE3&#39;</span><span style="color:var(--shiki-color-text);">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// æµ…å±‚</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">shallowRef</span><span style="color:var(--shiki-color-text);">({ name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ä¿®æ”¹ valï¼Œæ·±å±‚æ¬¡çš„ä¿®æ”¹(ç›´æ¥é€šè¿‡ .name ä¿®æ”¹)ï¼ŒshallowRef åä¸æ˜¯å“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">value</span><span style="color:var(--shiki-color-text);">.name </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE3&#39;</span><span style="color:var(--shiki-color-text);">;</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// åªå¯¹ val.value çš„ä¿®æ”¹äº§ç”Ÿå“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.value </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> { name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE3&#39;</span><span style="color:var(--shiki-color-text);"> };</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸ§¸-triggerref-api" tabindex="-1"><a class="header-anchor" href="#ğŸ§¸-triggerref-api" aria-hidden="true">#</a> ğŸ§¸ triggerRef Api</h3><p><strong>è§£å†³ shallowRef å¯¹äºæ·±å±‚æ¬¡çš„ä¿®æ”¹åï¼Œä¸ä¼šæ›´æ–°å¯¹åº”çš„å±æ€§ã€ä¸æ˜¯å“åº”å¼ã€‘</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ref</span><span style="color:var(--shiki-color-text);">({ name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ä¿®æ”¹ valï¼Œæ·±å±‚æ¬¡çš„ä¿®æ”¹(ç›´æ¥é€šè¿‡ .name ä¿®æ”¹)ï¼Œè¿˜æ˜¯å“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">value</span><span style="color:var(--shiki-color-text);">.name </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE3&#39;</span><span style="color:var(--shiki-color-text);">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// æµ…å±‚</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">shallowRef</span><span style="color:var(--shiki-color-text);">({ name</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE&#39;</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ä¿®æ”¹ valï¼Œæ·±å±‚æ¬¡çš„ä¿®æ”¹(ç›´æ¥é€šè¿‡ .name ä¿®æ”¹)ï¼ŒshallowRef åä¸æ˜¯å“åº”å¼</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">value</span><span style="color:var(--shiki-color-text);">.name </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;VUE3&#39;</span><span style="color:var(--shiki-color-text);">;</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// è°ƒç”¨ triggerRef è§¦å‘å“åº”å¼æ›´æ–°(æ‰‹åŠ¨è§¦å‘æ›´æ–°)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">triggerRef</span><span style="color:var(--shiki-color-text);">(val);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å…¶å®ƒ-api" tabindex="-1"><a class="header-anchor" href="#å…¶å®ƒ-api" aria-hidden="true">#</a> å…¶å®ƒ Api</h3><h4 id="ğŸ¿-customref-åˆ›å»ºè‡ªå®šä¹‰-ref" tabindex="-1"><a class="header-anchor" href="#ğŸ¿-customref-åˆ›å»ºè‡ªå®šä¹‰-ref" aria-hidden="true">#</a> ğŸ¿ customRef åˆ›å»ºè‡ªå®šä¹‰ ref</h4><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ref</span><span style="color:var(--shiki-color-text);">(value){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// æ¥å—ä¸¤ä¸ªå‚æ•° track(æ”¶é›†ä¾èµ–è§¦å‘æ›´æ–°)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-function);">customRef</span><span style="color:var(--shiki-color-text);">((track</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">trigger)</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		</span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			</span><span style="color:var(--shiki-token-function);">get</span><span style="color:var(--shiki-color-text);">(){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">				</span><span style="color:var(--shiki-token-function);">track</span><span style="color:var(--shiki-color-text);">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">				retrun value</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			}</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			</span><span style="color:var(--shiki-token-function);">set</span><span style="color:var(--shiki-color-text);">(newValue){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">				value</span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);">newValue;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">				</span><span style="color:var(--shiki-token-function);">track</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	})</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸ¨-computed-api" tabindex="-1"><a class="header-anchor" href="#ğŸ¨-computed-api" aria-hidden="true">#</a> ğŸ¨ computed Api</h3><p><strong>computed è¿”å›ä¸€ä¸ª ref å¯¹è±¡</strong></p></blockquote><blockquote><h3 id="ğŸ‰-watcheffect-api" tabindex="-1"><a class="header-anchor" href="#ğŸ‰-watcheffect-api" aria-hidden="true">#</a> ğŸ‰ watchEffect Api</h3><p><strong><code>watchEffect</code>ï¼šè‡ªåŠ¨æ”¶é›†å“åº”å¼æ•°æ®çš„ä¾èµ–ï¼Œé»˜è®¤å¼€å¯è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ref</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;0&#39;</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">watchEffect</span><span style="color:var(--shiki-color-text);">(()</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-constant);">console</span><span style="color:var(--shiki-token-function);">.log</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;æ‰§è¡Œ&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-constant);">val</span><span style="color:var(--shiki-color-text);">.value)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">/* æ¥å—ç¬¬ä¸‰ä¸ªå‚æ•° option */</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// éœ€è¦ä½¿ç”¨åˆ°è·å– dom æ•°æ®æ—¶å€™ â€˜postâ€™ï¼Œæ€»ä¹‹éƒ½ä¼šé»˜è®¤æ‰§è¡Œä¸€æ¬¡ï¼Œè¿›è¡Œä¾èµ–æ”¶é›†</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    flush</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-token-string-expression);">&#39;pre&#39;</span><span style="color:var(--shiki-color-text);">(é»˜è®¤å€¼ï¼Œé»˜è®¤ä¸€å¼€å§‹æ‰§è¡Œä¸€æ¬¡)</span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-string-expression);">&#39;post&#39;</span><span style="color:var(--shiki-color-text);">(dom æŒ‚è½½oræ›´æ–°å®Œæ‰§è¡Œä¸€æ¬¡)</span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-token-string-expression);">&#39;sync&#39;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>é»˜è®¤è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œ<code>å¹¶åœ¨æ‰§è¡Œåæ”¶é›†å“åº”å¼ä¾èµ–</code>ï¼Œå½“ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°æ‰§è¡Œ</strong></p><p><strong><code>åœæ­¢ watchEffect ç›‘å¬</code>ï¼ŒwatchEffect ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“æ‰§è¡Œè¿”å›çš„å‡½æ•°æ—¶ï¼Œå°±ä¼šåœæ­¢ watchEffect çš„ç›‘å¬</strong></p><p><strong>æ¸…é™¤å‰¯ä½œç”¨</strong></p><p>åœ¨å¼€å‘ä¸­éœ€è¦åœ¨ç›‘å¬å‡½æ•°ä¸­æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯åœ¨ç½‘ç»œè¯·æ±‚è¿˜æ²¡æœ‰è¾¾åˆ°çš„æ—¶å€™ï¼Œæˆ–è€…ç›‘å¬å™¨ç›‘å¬å‡½æ•°è¢«å†æ¬¡æ‰§è¡Œã€‚é‚£ä¹ˆä¸Šä¸€æ¬¡çš„ç½‘ç»œè¯·æ±‚åº”è¯¥è¢«å–æ¶ˆæ‰ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ¸…é™¤ä¸Šä¸€æ¬¡çš„å‰¯ä½œç”¨</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// watchEffect æ¥å—ä¸€ä¸ªå‚æ•°å›è°ƒå‡½æ•°ï¼Œfn é‡Œé¢å†ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ç”¨äºå–æ¶ˆæ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">watchEffect</span><span style="color:var(--shiki-color-text);">((fn) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-comment);">// å½“å‰¯ä½œç”¨å³å°†é‡æ–°æ‰§è¡Œæˆ–è€…ç›‘å¬å™¨è¢«åœæ­¢æ—¶ä¼šæ‰§è¡Œè¯¥å‡½æ•°ä¼ å…¥çš„å›è°ƒå‡½æ•°</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-function);">fn</span><span style="color:var(--shiki-color-text);">(() </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		</span><span style="color:var(--shiki-token-comment);">// ...å–æ¶ˆæ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	});</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">});</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ¡-watch-api" tabindex="-1"><a class="header-anchor" href="#ğŸ¡-watch-api" aria-hidden="true">#</a> ğŸ¡ watch Api</h3><p><strong><code>watch</code>ï¼šæ‰‹åŠ¨æŒ‡å®šç›‘å¬çš„æ•°æ®æº</strong></p><p><strong>åŸºæœ¬åŒ options Api</strong></p><p><strong>æ¥å—æ¥å—å››ç§ç±»å‹çš„ç›®æ ‡æºï¼šgetter å‡½æ•°å¹¶è¿”å›ä¸€ä¸ªå“åº”å¼æ•°æ®ã€ref å¯¹è±¡</strong>ã€...</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);">æ³¨æ„ï¼švue å¯¹ reactive ç±»å‹çš„ä¼ å‚æ—¶ï¼ŒnewValue ä¸ oldValue æ˜¯ä¸€ä¸ª Porxy å¯¹è±¡ï¼Œref å…¶å®ƒç±»å‹ä¸ºåŸç”Ÿçš„æ•°æ®ğŸ€ğŸ€ğŸ€</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// è§£å†³ reactive ç±»å‹çš„ä¼ å‚æ—¶ï¼ŒnewValue ä¸ oldValue æ˜¯ä¸€ä¸ª Porxy å¯¹è±¡</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">watch</span><span style="color:var(--shiki-color-text);">(()</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">...</span><span style="color:var(--shiki-color-text);">reactive</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">(newValue</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">oldValue)</span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">})</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// æ‰§è¡Œ,å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒ</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">export</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">watch</span><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-function);">T</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">any</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">Immediate</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">extends</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">Readonly</span><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-constant);">boolean</span><span style="color:var(--shiki-color-text);">&gt; </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span><span style="color:var(--shiki-color-text);">&gt;(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  source</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">T</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchSource</span><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-function);">T</span><span style="color:var(--shiki-color-text);">&gt;</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  cb</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">any</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  options</span><span style="color:var(--shiki-token-keyword);">?:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchOptions</span><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-function);">Immediate</span><span style="color:var(--shiki-color-text);">&gt;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">)</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchStopHandle</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(cb)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-string-expression);">`\`watch(fn, options?)\` signature has been moved to a separate API. `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`Use \`watchEffect(fn, options?)\` instead. \`watch\` now only `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`supports \`watch(source, cb, options?) signature.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// ...æ‰§è¡Œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">doWatch</span><span style="color:var(--shiki-color-text);">(source </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">any</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> cb</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> options)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">doWatch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  source</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchSource</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchSource</span><span style="color:var(--shiki-color-text);">[] </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchEffect</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">object</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  cb</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchCallback</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  { immediate</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> deep</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> flush</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> onTrack</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> onTrigger }</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchOptions</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">EMPTY_OBJ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">)</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">WatchStopHandle</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">!</span><span style="color:var(--shiki-color-text);">cb) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (immediate </span><span style="color:var(--shiki-token-keyword);">!==</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">undefined</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`watch() &quot;immediate&quot; option is only respected when using the `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-string-expression);">`watch(source, callback, options?) signature.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (deep </span><span style="color:var(--shiki-token-keyword);">!==</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">undefined</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`watch() &quot;deep&quot; option is only respected when using the `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-string-expression);">`watch(source, callback, options?) signature.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">warnInvalidSource</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (s</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">unknown</span><span style="color:var(--shiki-color-text);">) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-string-expression);">`Invalid watch source: `</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      s</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-string-expression);">`A watch source can only be a getter/effect function, a ref, `</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">+</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-string-expression);">`a reactive object, or an array of these types.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> currentInstance</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// ç›‘å¬çš„æ•°æ®æºä¼šèµ‹å€¼ getter å‡½æ•°</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">any</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> forceTrigger </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> isMultiSource </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// æ¥å—å››ç§ç±»å‹</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­æ˜¯å¦refå¯¹è±¡</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isRef</span><span style="color:var(--shiki-color-text);">(source)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">source</span><span style="color:var(--shiki-color-text);">.value</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    forceTrigger </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isShallow</span><span style="color:var(--shiki-color-text);">(source)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isReactive</span><span style="color:var(--shiki-color-text);">(source)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> source</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­reactiveé»˜è®¤å¼€å¯deep</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    deep </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isArray</span><span style="color:var(--shiki-color-text);">(source)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­å¼€å¯å¤šç›®æ ‡æºç›‘å¬</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    isMultiSource </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    forceTrigger </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">source</span><span style="color:var(--shiki-token-function);">.some</span><span style="color:var(--shiki-color-text);">(s </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isReactive</span><span style="color:var(--shiki-color-text);">(s) </span><span style="color:var(--shiki-token-keyword);">||</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">isShallow</span><span style="color:var(--shiki-color-text);">(s))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-constant);">source</span><span style="color:var(--shiki-token-function);">.map</span><span style="color:var(--shiki-color-text);">(s </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isRef</span><span style="color:var(--shiki-color-text);">(s)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">s</span><span style="color:var(--shiki-color-text);">.value</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isReactive</span><span style="color:var(--shiki-color-text);">(s)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">traverse</span><span style="color:var(--shiki-color-text);">(s)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(s)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">callWithErrorHandling</span><span style="color:var(--shiki-color-text);">(s</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ErrorCodes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">WATCH_GETTER</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          __DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">warnInvalidSource</span><span style="color:var(--shiki-color-text);">(s)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isFunction</span><span style="color:var(--shiki-color-text);">(source)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (cb) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// getter with cb</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">callWithErrorHandling</span><span style="color:var(--shiki-color-text);">(source</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> instance</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ErrorCodes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">WATCH_GETTER</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// no cb -&gt; simple effect</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">getter</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (instance </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">instance</span><span style="color:var(--shiki-color-text);">.isUnmounted) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">return</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (cleanup) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">cleanup</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">callWithAsyncErrorHandling</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          source</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          instance</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-constant);">ErrorCodes</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">WATCH_CALLBACK</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          [onCleanup]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    getter </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">NOOP</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    __DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">warnInvalidSource</span><span style="color:var(--shiki-color-text);">(source)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸ‰-ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#ğŸ‰-ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> ğŸ‰ ç”Ÿå‘½å‘¨æœŸ</h3><p><strong>composition Api ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸º<code>ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¯ä»¥æ³¨å†Œå¤šä¸ªç”Ÿå‘½å‘¨æœŸ(å¯ä»¥è¿›è¡Œä»£ç è§£è€¦ï¼Œå°è£… hook)</code></strong></p><p>æ³¨æ„ï¼š<code>Vue3 ä¸­æ²¡æœ‰ beforeCreateã€createï¼Œ</code><strong><code>setup å‡½æ•°ä»£æ›¿äº†å®ƒä»¬ï¼Œå¹¶ä¸”æ¯”å®ƒä»¬è¿˜è¦æ—©æ‰§è¡Œ</code></strong></p><p><strong>options Api ä¸­ï¼ŒbeforeCreateã€create çš„å®ç°ä¸å…¶å®ƒçš„é’©å­å‡½æ•°å®ç°åŸç†ä¸ä¸€æ ·</strong></p></blockquote><blockquote><h3 id="ğŸ€-vue3-ä¾èµ–æ³¨å…¥-provide-inject" tabindex="-1"><a class="header-anchor" href="#ğŸ€-vue3-ä¾èµ–æ³¨å…¥-provide-inject" aria-hidden="true">#</a> ğŸ€ VUE3 ä¾èµ–æ³¨å…¥ provide inject</h3><p><strong>ä½¿ç”¨æ–¹æ³•åŸºæœ¬åŒ options Apiï¼Œä¸åŒçš„æ˜¯å“åº”å¼æ•°æ®çš„å¤„ç†ï¼Œoptions Api å“åº”å¼æ•°æ®éœ€è¦å¯¼å…¥ computed æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œå“åº”å¼è½¬åŒ–ï¼Œcomposition Api é€šè¿‡ ref æˆ–è€… reactive å£°æ˜å³å¯</strong></p><p><strong>æ³¨æ„ï¼šå°½é‡ä¸è¦åœ¨å­ç»„ä»¶ inject è·å–æ•°æ®å»ä¿®æ”¹çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„æ•°æ®ï¼Œä¼ é€’åº”å½“è¿›è¡Œ readonly åªè¯»å¤„ç†ã€éµå¾ªå•å‘æ•°æ®æµã€‘</strong></p></blockquote><blockquote><h3 id="ğŸ¿-hook" tabindex="-1"><a class="header-anchor" href="#ğŸ¿-hook" aria-hidden="true">#</a> ğŸ¿ Hook</h3><p><strong>è§„èŒƒä»¥ <code>use</code> å‰ç¼€å¼€å§‹å‘½å</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">export</span><span style="color:var(--shiki-color-text);"> useXXX = function(){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	const xxx = ref(&#39;xxx&#39;)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	const yyy = ()=&gt;{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		xxx.value = &#39;yyy&#39;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// è¿”å›åŠŸèƒ½å±æ€§æ–¹æ³•...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		xxx</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		yyy</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	}</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// ä½¿ç”¨</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">xxx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-constant);">yyy</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">useXXX</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// åŒæ ·å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ ...(ç¼ºç‚¹ï¼šä¸æ¸…æ¥šæ•°æ®æ¥æº)</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">...</span><span style="color:var(--shiki-color-text);">useXXX</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><blockquote><h3 id="ğŸ§¸-h-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ğŸ§¸-h-å‡½æ•°" aria-hidden="true">#</a> ğŸ§¸ h å‡½æ•°</h3><p><strong>Vue æ¨èåœ¨ç»å¤§æ•°æƒ…å†µä¸‹ä½¿ç”¨æ¨¡æ¿æ¥åˆ›å»ºä½ çš„ HTMLï¼Œå¯¹äºä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ï¼ŒçœŸçš„éœ€è¦ JavaScript çš„å®Œå…¨ç¼–ç¨‹çš„èƒ½åŠ›ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨æ¸²æŸ“å‡½æ•°ï¼Œ<code>å®ƒæ¯”æ¨¡æ¿æ›´æ¥è¿‘ç¼–è¯‘å™¨ğŸ‰</code></strong></p><p><strong>Vue åœ¨ç”ŸæˆçœŸå®çš„ DOM ä¹‹å‰ï¼Œä¼š<code>å°†èŠ‚ç‚¹è½¬æ¢æˆ VNode è™šæ‹ŸèŠ‚ç‚¹</code>ï¼Œè€Œ <code>VNode è™šæ‹ŸèŠ‚ç‚¹ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€é¢—æ ‘ç»“æ„</code>ï¼Œè¿™æ£µæ ‘å°±æ˜¯è™šæ‹Ÿ DOMã€VDOMã€‘</strong></p><p><strong>äº‹å®ä¸Šï¼Œ<code>é€šè¿‡ç¼–å†™ template HTML æ–¹å¼æœ€ç»ˆä¹Ÿæ˜¯é€šè¿‡ä½¿ç”¨ æ¸²æŸ“å‡½æ•° ç”Ÿæˆå¯¹åº”çš„ VNode è™šæ‹ŸèŠ‚ç‚¹</code></strong></p><p><strong><code>template ç»è¿‡ compile ç¼–è¯‘è½¬åŒ– render è°ƒç”¨å‡½æ•°è¿”å› VNode</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// Vue2 h å‡½æ•°ä½œä¸º render çš„å‚æ•°å»æ¥å—</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// Vue3 h å‡½æ•°éœ€è¦é€šè¿‡ import å¯¼å…¥</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">render</span><span style="color:var(--shiki-color-text);">(h){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-comment);">// retrun VNode</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// æ¥å—ä¸‰ä¸ªå‚æ•°</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 1ã€æ ‡ç­¾ï¼šstring | object | function æ ‡ç­¾åã€ç»„ä»¶ã€å¼‚æ­¥ç»„ä»¶(å¼•å…¥ç»„ä»¶æ—¶ä¸éœ€è¦æ³¨å†Œç»„ä»¶ç›´æ¥ä½¿ç”¨)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 2ã€props å±æ€§äº‹ä»¶...ï¼Œæ²¡æœ‰æ—¶å€™æ²¡æœ‰ä¸ä¼ ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä½œä¸ºç¬¬äºŒå‚æ•°ï¼Œä½†æ˜¯å»ºè®®ä½¿ç”¨ null å ä½</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 3ã€å­å…ƒç´ ï¼šstring | array | object | æ’æ§½slot</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">h</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;div&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">{</span><span style="color:var(--shiki-token-comment);">/* å±æ€§ */</span><span style="color:var(--shiki-color-text);">}</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">[</span><span style="color:var(--shiki-token-comment);">/* å­å…ƒç´  */</span><span style="color:var(--shiki-color-text);">]</span><span style="color:var(--shiki-token-keyword);">||</span><span style="color:var(--shiki-color-text);">æ ‡ç­¾å†…å®¹)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// è¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨ this è®¿é—®å“åº”å¼å±æ€§ï¼Ÿå› ä¸º render å‡½æ•°æ˜¯æœ‰ç»™ç»‘å®š this çš„</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">h</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;div&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-string-expression);">`</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-color-text);">.xxx</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// Vue3 h å‡½æ•°å†™æ³•</span></span>
<span class="line"><span style="color:var(--shiki-token-function);">setup</span><span style="color:var(--shiki-color-text);">(){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">xxx</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ref</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;yyy&#39;</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">retrun</span><span style="color:var(--shiki-color-text);"> ()</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">h</span><span style="color:var(--shiki-color-text);">(xxx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">xxx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-string-expression);">`</span><span style="color:var(--shiki-token-keyword);">${</span><span style="color:var(--shiki-token-constant);">xxx</span><span style="color:var(--shiki-color-text);">.value</span><span style="color:var(--shiki-token-keyword);">}</span><span style="color:var(--shiki-token-string-expression);">`</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">h</span><span style="color:var(--shiki-color-text);">(ç»„ä»¶</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">xxx</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            default</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-token-function);">å‡½æ•°</span><span style="color:var(--shiki-color-text);">(props)</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-token-function);">h</span><span style="color:var(--shiki-color-text);">()</span><span style="color:var(--shiki-token-comment);">// çˆ¶ç»„ä»¶å®šä¹‰</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-token-function);">.</span><span style="color:var(--shiki-token-constant);">$slot</span><span style="color:var(--shiki-token-function);">.default</span><span style="color:var(--shiki-color-text);">()</span><span style="color:var(--shiki-token-keyword);">??</span><span style="color:var(--shiki-token-string-expression);">&#39;&#39;</span><span style="color:var(--shiki-token-comment);">// å­ç»„ä»¶ä½¿ç”¨</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// jsx å†™æ³•ï¼Œè„šæ‰‹æ¶ä¸æ”¯æŒéœ€è¦ä½¿ç”¨ Babel è½¬åŒ–</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">jsx </span><span style="color:var(--shiki-token-keyword);">-&gt;</span><span style="color:var(--shiki-color-text);"> è½¬åŒ– </span><span style="color:var(--shiki-token-keyword);">-&gt;</span><span style="color:var(--shiki-color-text);"> h å‡½æ•° </span><span style="color:var(--shiki-token-keyword);">-&gt;</span><span style="color:var(--shiki-color-text);"> VNode </span><span style="color:var(--shiki-token-keyword);">-&gt;</span><span style="color:var(--shiki-color-text);"> VDom</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="diff-ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#diff-ç®—æ³•" aria-hidden="true">#</a> diff ç®—æ³•</h3><blockquote><h4 id="ğŸ¨-key-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#ğŸ¨-key-çš„ä½œç”¨" aria-hidden="true">#</a> ğŸ¨ key çš„ä½œç”¨</h4><p><strong>key å±æ€§ä¸»è¦ç”¨äº Vue çš„è™šæ‹Ÿ DOM ç®—æ³•ï¼Œ<code>åœ¨æ–°æ—§èŠ‚ç‚¹ nodes å¯¹æ¯”æ—¶ï¼Œè¾¨è¯† VNode</code></strong></p><p><strong>ä¸ä½¿ç”¨ Keyï¼šå¦‚æœä¸ä½¿ç”¨ keyï¼Œ<code>Vue ä¼šä½¿ç”¨ä¸€ç§æœ€å¤§é™åº¦å‡å°‘åŠ¨æ€å…ƒç´ å¹¶ä¸”å°½å¯èƒ½å°è¯•åœ°ä¿®æ”¹ or ä¿®å¤ç›¸åŒç±»å‹çš„å…ƒç´ çš„ç®—æ³•</code></strong></p><p><strong>ä½¿ç”¨ Keyï¼šVue ä¼šåŸºäº Key çš„å˜åŒ–<code>(æ ¹æ® Key)ï¼Œé‡æ–°æ’åºå…ƒç´ çš„é¡ºåºï¼Œå¹¶ä¸”ç§»é™¤é”€æ¯ä¸å­˜åœ¨çš„ Key å…ƒç´ </code></strong></p><h5 id="ğŸŒ-vnode-è™šæ‹ŸèŠ‚ç‚¹" tabindex="-1"><a class="header-anchor" href="#ğŸŒ-vnode-è™šæ‹ŸèŠ‚ç‚¹" aria-hidden="true">#</a> ğŸŒ VNode è™šæ‹ŸèŠ‚ç‚¹</h5><p>æµ…å±‚æ¬¡ç†è§£ï¼š<strong>çœŸå®èŠ‚ç‚¹ HTMLã€<code>h1ã€divã€span</code>ã€‘ï¼Œè™šæ‹ŸèŠ‚ç‚¹ VNode <code>Javascript å¯¹è±¡</code>ã€å­˜åœ¨å†…å­˜å½“ä¸­ã€‘</strong></p><p><strong>äº‹å®ä¸Šï¼Œ<code>æ— è®ºæ˜¯ç»„ä»¶è¿˜æ˜¯å…ƒç´ ï¼Œåœ¨ Vue ä¸­è¡¨ç°å‡ºæ¥çš„éƒ½æ˜¯ä¸€ä¸ªä¸ª VNode</code>ï¼ŒVue ä¼šå°†æ¨¡æ¿ä¸­çš„ä¸€ä¸ªä¸ªç»„ä»¶æˆ–è€…å…ƒç´ è½¬æ¢æˆ VNode å¯¹è±¡ã€å‚è€ƒ h å‡½æ•°ã€‘</strong></p><p><strong>VNodeï¼šæœ¬è´¨ Javascript å¯¹è±¡ï¼Œç”¨äºæè¿°ç»„ä»¶æˆ–è€…æ ‡ç­¾ï¼Œä¸ºä»€ä¹ˆè¦å¤šæ­¤ä¸€ä¸¾é€šè¿‡ VNode å†è½¬æ¢ VDom å†çœŸå® Domï¼Ÿå¯ä»¥å¤šå¹³å°é€‚é…ã€æœåŠ¡ç«¯æ¸²æŸ“ã€ç§»åŠ¨ç«¯æ¸²æŸ“ã€è·¨å¹³å°æ¸²æŸ“ã€‘</strong></p><h5 id="ğŸ›µ-vdom-è™šæ‹Ÿ-dom" tabindex="-1"><a class="header-anchor" href="#ğŸ›µ-vdom-è™šæ‹Ÿ-dom" aria-hidden="true">#</a> ğŸ›µ VDom è™šæ‹Ÿ DOM</h5><p><strong><code>é€šè¿‡ä¸€ä¸ªä¸ª VNode å¯¹è±¡å…³ç³»æ•´åˆï¼Œå½¢æˆçš„ä¸€é¢—å¯¹è±¡æ ‘ï¼Œç§°ä¹‹ä¸º è™šæ‹Ÿ DOM</code></strong></p><p><strong>é€šè¿‡è™šæ‹Ÿ DOM æ¸²æŸ“æˆä¸ºçœŸå®çš„ DOMï¼Œåœ¨æµè§ˆå™¨å±•ç¤ºï¼Œéœ€è¦çŸ¥é“çš„æ˜¯ï¼ŒVDOM ä¸çœŸå®çš„ DOM å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œè™šæ‹Ÿ DOM å­˜åœ¨ä¸€äº› Vue ç»„ä»¶( VNode )</strong></p><h5 id="ä¸¾ä¸ª-ğŸŒ°" tabindex="-1"><a class="header-anchor" href="#ä¸¾ä¸ª-ğŸŒ°" aria-hidden="true">#</a> ä¸¾ä¸ª ğŸŒ°</h5><p><strong>å½“åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ä»»æ„ä½ç½®æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚ä½•æ‰èƒ½é«˜æ•ˆæ›´æ–° DOM?</strong></p><p>1ã€å…¨éƒ¨å¹²æ‰ï¼Œé‡æ–°æ›´æ–°æ•°ç»„é‡Œé¢æ‰€æœ‰å…ƒç´ ã€æœ€ä¸é«˜æ•ˆã€‘</p><p>2ã€å› ä¸ºåœ¨æ’å…¥çš„å…ƒç´ ä¸­ï¼Œæ•°ç»„å‰é¢çš„å…ƒç´ ä½ç½®ä¸å˜ï¼Œåé¢å…ƒç´ çš„ä½ç½®æ‰ä¼šæ”¹å˜ï¼Œå‰é¢å…ƒç´ ä¸å˜ï¼Œæ›´æ–°åé¢çš„å…ƒç´ ã€è¿˜ä¸é”™ã€‘ã€<code>æ—  Keyåšæ³•</code>ã€‘</p><p><strong>3ã€ç›´æ¥åœ¨æ•°ç»„ä¸­æ’å…¥éœ€è¦æ’å…¥çš„å…ƒç´ ã€æœ€é«˜æ•ˆã€‘ï¼Œæ€ä¹ˆæ’ï¼Ÿ ğŸƒ é€šè¿‡ æ–°æ—§ VDom(VNodes) å¯¹æ¯”æ ¹æ®éœ€è¦å˜åŒ–åœ°æ–¹è¿›è¡Œæ›´æ–°ï¼Œã€æ€ä¹ˆå¯¹æ¯”ï¼Ÿè¿™å°±æ˜¯ diff ç®—æ³•åšçš„äº‹æƒ…ï¼ŒKey çš„ä½œç”¨ã€‘ã€<code>æœ‰ Key</code>ã€‘</strong></p><p>åœ¨æºç ä¸­ï¼Œå¦‚æœå­˜åœ¨ Keyï¼Œåˆ™è°ƒç”¨çš„æ˜¯ pathKeyedChildrenï¼Œä¸å­˜åœ¨ Keyï¼Œè°ƒç”¨ pathUnKeyedChildren</p><p><code>D:\Material\Vueæºç è§£æ\core\packages\runtime-core\src\renderer.tsï¼š1593</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">patchChildren</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">PatchChildrenFn</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    n1</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    optimized </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  ) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> n1 </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n1</span><span style="color:var(--shiki-color-text);">.children</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">prevShapeFlag</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> n1 </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n1</span><span style="color:var(--shiki-color-text);">.shapeFlag </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c2</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n2</span><span style="color:var(--shiki-color-text);">.children</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">patchFlag</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">shapeFlag</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> n2</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// fast path</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (patchFlag </span><span style="color:var(--shiki-token-keyword);">&gt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// åˆ¤æ–­ key æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (patchFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">PatchFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">KEYED_FRAGMENT</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// this could be either fully-keyed or mixed (some keyed some not)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">//patchFlag çš„å­˜åœ¨æ„å‘³ç€å­å…ƒç´ è¢«ä¿è¯æ˜¯æ•°ç»„</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">patchKeyedChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          c1 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// æ—§çš„ VNodes</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          c2 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// æ–°çš„ VNodes</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (patchFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">PatchFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">UNKEYED_FRAGMENT</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// unkeyed æ— é”®</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">patchUnkeyedChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          c1 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          c2 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">return</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">//children æœ‰ 3 ç§å¯èƒ½æ€§ï¼šæ–‡æœ¬ã€æ•°ç»„æˆ–æ— å­é¡¹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (shapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">TEXT_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// text children fast path</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (prevShapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">ARRAY_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">unmountChildren</span><span style="color:var(--shiki-color-text);">(c1 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentSuspense)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (c2 </span><span style="color:var(--shiki-token-keyword);">!==</span><span style="color:var(--shiki-color-text);"> c1) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">hostSetElementText</span><span style="color:var(--shiki-color-text);">(container</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> c2 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">string</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (prevShapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">ARRAY_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// prev children was array</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (shapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">ARRAY_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// two arrays, cannot assume anything, do full diff</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">patchKeyedChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            c1 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            c2 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// no new children, just unmount old</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">unmountChildren</span><span style="color:var(--shiki-color-text);">(c1 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// prev children was text OR null</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// new children is array OR null</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (prevShapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">TEXT_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">hostSetElementText</span><span style="color:var(--shiki-color-text);">(container</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;&#39;</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// mount new if array</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (shapeFlag </span><span style="color:var(--shiki-token-keyword);">&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">ShapeFlags</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">ARRAY_CHILDREN</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">mountChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            c2 </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="patchkeyedchildren" tabindex="-1"><a class="header-anchor" href="#patchkeyedchildren" aria-hidden="true">#</a> patchKeyedChildren</h5><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// can be all-keyed or mixed</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">patchKeyedChildren</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c1</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c2</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    container</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererElement</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentAnchor</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererNode</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentComponent</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentSuspense</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">SuspenseBoundary</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    isSVG</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    slotScopeIds</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">string</span><span style="color:var(--shiki-color-text);">[] </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    optimized</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  ) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">l2</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c2</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-token-comment);">// è·å–æ—§ VNodes é•¿åº¦</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> e1 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c1</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// æ–° VNode ç»“æŸçš„ç´¢å¼•</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> e2 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> l2 </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// æ—§ VNode ç»“æŸçš„ç´¢å¼•</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// å¤šç§æ“ä½œæ•°ç»„çš„æ–¹æ³•åˆ¤æ–­</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 1. ä»å¤´éƒ¨å¼€å§‹éå†æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b) c</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b) d e</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">while</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e1 </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c1[i] </span><span style="color:var(--shiki-token-comment);">// æ–° vnode</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n2</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (c2[i] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">cloneIfMounted</span><span style="color:var(--shiki-color-text);">(c2[i] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">normalizeVNode</span><span style="color:var(--shiki-color-text);">(c2[i])) </span><span style="color:var(--shiki-token-comment);">// æ—§ vnode</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// æ˜¯ç›¸åŒçš„ vnodeï¼Œé€šè¿‡ key and ç±»å‹ åˆ¤æ–­</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isSameVNodeType</span><span style="color:var(--shiki-color-text);">(n1</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> n2)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          n1</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// ä¸ç›¸åŒ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// æ‰¾åˆ°å¯¹æ¯”ä¸ç›¸åŒçš„ vnode è·³å‡ºå¾ªç¯ï¼Œåˆ°ä¸‹ä¸€æ­¥ 2</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">break</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// å¤´éƒ¨å– ++ æ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      i</span><span style="color:var(--shiki-token-keyword);">++</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 2. ä»å°¾éƒ¨éå†æ¯”è¾ƒ e1 e2(å°¾éƒ¨é•¿åº¦)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// a (b c)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// d e (b c)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">while</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e1 </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// æ“ä½œåŒä¸Š 1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c1[e1]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">n2</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (c2[e2] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">cloneIfMounted</span><span style="color:var(--shiki-color-text);">(c2[e2] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">normalizeVNode</span><span style="color:var(--shiki-color-text);">(c2[e2]))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-function);">isSameVNodeType</span><span style="color:var(--shiki-color-text);">(n1</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> n2)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          n1</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          n2</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// æ‰¾åˆ°å¯¹æ¯”ä¸ç›¸åŒçš„ vnode è·³å‡ºå¾ªç¯ï¼Œåˆ°ä¸‹ä¸€æ­¥ 3</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">break</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// å°¾éƒ¨å– -- æ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      e1</span><span style="color:var(--shiki-token-keyword);">--</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      e2</span><span style="color:var(--shiki-token-keyword);">--</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 3. å½“æ¯”è¾ƒå‘ç° c2 æ–° vnode æ–°å¢çš„ï¼ŒæŒ‚è½½æ–° vnode</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b) c</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// i = 2, e1 = 1, e2 = 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// c (a b)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// i = 0, e1 = -1, e2 = 0</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&gt;</span><span style="color:var(--shiki-color-text);"> e1) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">nextPos</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> e2 </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-token-comment);">// è·å–æ–° vnode ä½ç½®</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">anchor</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> nextPos </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> l2 </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> (c2[nextPos] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">).el </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> parentAnchor</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">while</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// åˆ©ç”¨ç©ºçš„ ä¸ c2 æ–°çš„æ¯”è¾ƒï¼Œå½“è¿™é‡Œä¸ºç©ºè¡¨ç¤ºä¸ºä¸€ä¸ªæŒ‚æ“ä½œ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            (c2[i] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">cloneIfMounted</span><span style="color:var(--shiki-color-text);">(c2[i] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">normalizeVNode</span><span style="color:var(--shiki-color-text);">(c2[i]))</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          i</span><span style="color:var(--shiki-token-keyword);">++</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 4. å½“æ¯”è¾ƒå‘ç° c1 æ—§ vnodeï¼Œå‰©ä½™å¤šä½™çš„ï¼Œå¸è½½å¤šä½™çš„ vnode</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b) c</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (a b)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// i = 2, e1 = 2, e2 = 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// a (b c)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// (b c)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// i = 0, e1 = 0, e2 = -1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&gt;</span><span style="color:var(--shiki-color-text);"> e2) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">while</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e1) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-function);">unmount</span><span style="color:var(--shiki-color-text);">(c1[i]</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        i</span><span style="color:var(--shiki-token-keyword);">++</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 5. å½“æ¯”è¾ƒå®Œå‰åï¼Œå‘ç°ä¸­é—´äº§ç”Ÿæ¯”è¾ƒå¤šçš„äº¤å‰é”™ä¹±çš„ vnode(æ— åºçš„ï¼Œä¹±ä¸ƒå…«ç³Ÿçš„)ï¼ŒVue å¹¶ä¸æ˜¯å…¨éƒ¨åˆ é™¤é‡æ–°æŒ‚è½½</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// å¦‚æœå¯¹æ¯”å‘ç°æ˜¯å¤šä½™çš„(c1é‡Œé¢)ï¼Œé™¤å»</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// å¦‚æœå¯¹æ¯”å‘ç°æ˜¯å­˜åœ¨çš„ï¼Œç±»å‹ç›¸åŒçš„ï¼Œæˆ–è€…æ–°çš„ï¼Œé‚£ä¹ˆã€ç§»åŠ¨å’ŒæŒ‚è½½æ–°çš„ vnodeã€‘</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// [i ... e1 + 1]: a b [c d e] f g</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// [i ... e2 + 1]: a b [e d c h] f g</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// i = 2, e1 = 4, e2 = 5</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">s1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-comment);">// prev starting index</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">s2</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-comment);">// next starting index</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// 5.1 build key:index map for newChildren</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">keyToNewIndexMap</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">Map</span><span style="color:var(--shiki-color-text);">&lt;</span><span style="color:var(--shiki-token-constant);">string</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">number</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">symbol</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">number</span><span style="color:var(--shiki-color-text);">&gt; </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">new</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Map</span><span style="color:var(--shiki-color-text);">()</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> s2; i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (c2[i] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">cloneIfMounted</span><span style="color:var(--shiki-color-text);">(c2[i] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">normalizeVNode</span><span style="color:var(--shiki-color-text);">(c2[i]))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);">.key </span><span style="color:var(--shiki-token-keyword);">!=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (__DEV__ </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">keyToNewIndexMap</span><span style="color:var(--shiki-token-function);">.has</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);">.key)) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-function);">warn</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-string-expression);">`Duplicate keys found during update:`</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-constant);">JSON</span><span style="color:var(--shiki-token-function);">.stringify</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);">.key)</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-string-expression);">`Make sure keys are unique.`</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-constant);">keyToNewIndexMap</span><span style="color:var(--shiki-token-function);">.set</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);">.key</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> i)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// 5.2 loop through old children left to be patched and try to patch</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// matching nodes &amp; remove nodes that are no longer present</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> j</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> patched </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">toBePatched</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> e2 </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> s2 </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> moved </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// used to track whether any node has moved</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> maxNewIndexSoFar </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// works as Map&lt;newIndex, oldIndex&gt;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// Note that oldIndex is offset by +1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// and oldIndex = 0 is a special value indicating the new node has</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// no corresponding old node.</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// used for determining longest stable subsequence</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">newIndexToOldIndexMap</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">new</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Array</span><span style="color:var(--shiki-color-text);">(toBePatched)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">; i </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> toBePatched; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) newIndexToOldIndexMap[i] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> s1; i </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e1; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">prevChild</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c1[i]</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (patched </span><span style="color:var(--shiki-token-keyword);">&gt;=</span><span style="color:var(--shiki-color-text);"> toBePatched) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// all new children have been patched so this can only be a removal</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">unmount</span><span style="color:var(--shiki-color-text);">(prevChild</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">continue</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> newIndex</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">prevChild</span><span style="color:var(--shiki-color-text);">.key </span><span style="color:var(--shiki-token-keyword);">!=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          newIndex </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">keyToNewIndexMap</span><span style="color:var(--shiki-token-function);">.get</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">prevChild</span><span style="color:var(--shiki-color-text);">.key)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// key-less node, try to locate a key-less node of the same type</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (j </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> s2; j </span><span style="color:var(--shiki-token-keyword);">&lt;=</span><span style="color:var(--shiki-color-text);"> e2; j</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              newIndexToOldIndexMap[j </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> s2] </span><span style="color:var(--shiki-token-keyword);">===</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">&amp;&amp;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-function);">isSameVNodeType</span><span style="color:var(--shiki-color-text);">(prevChild</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> c2[j] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            ) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              newIndex </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> j</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">              </span><span style="color:var(--shiki-token-keyword);">break</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (newIndex </span><span style="color:var(--shiki-token-keyword);">===</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">undefined</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">unmount</span><span style="color:var(--shiki-color-text);">(prevChild</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          newIndexToOldIndexMap[newIndex </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> s2] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (newIndex </span><span style="color:var(--shiki-token-keyword);">&gt;=</span><span style="color:var(--shiki-color-text);"> maxNewIndexSoFar) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            maxNewIndexSoFar </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> newIndex</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            moved </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            prevChild</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            c2[newIndex] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          patched</span><span style="color:var(--shiki-token-keyword);">++</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// 5.3 move and mount</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// generate longest stable subsequence only when nodes have moved</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">increasingNewIndexSequence</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> moved</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">getSequence</span><span style="color:var(--shiki-color-text);">(newIndexToOldIndexMap)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">EMPTY_ARR</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      j </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">increasingNewIndexSequence</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// looping backwards so that we can use last patched node as anchor</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> toBePatched </span><span style="color:var(--shiki-token-keyword);">-</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);">; i </span><span style="color:var(--shiki-token-keyword);">&gt;=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">; i</span><span style="color:var(--shiki-token-keyword);">--</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">nextIndex</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> s2 </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> i</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c2[nextIndex] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">anchor</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          nextIndex </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> l2 </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> (c2[nextIndex </span><span style="color:var(--shiki-token-keyword);">+</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">1</span><span style="color:var(--shiki-color-text);">] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">).el </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> parentAnchor</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (newIndexToOldIndexMap[i] </span><span style="color:var(--shiki-token-keyword);">===</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// mount new</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            nextChild</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (moved) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// move if:</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// There is no stable subsequence (e.g. a reverse)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-comment);">// OR current node is not among the stable sequence</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (j </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">||</span><span style="color:var(--shiki-color-text);"> i </span><span style="color:var(--shiki-token-keyword);">!==</span><span style="color:var(--shiki-color-text);"> increasingNewIndexSequence[j]) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            </span><span style="color:var(--shiki-token-function);">move</span><span style="color:var(--shiki-color-text);">(nextChild</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> container</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> anchor</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">MoveType</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">REORDER</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            j</span><span style="color:var(--shiki-token-keyword);">--</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">          }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="patchunkeyedchildren" tabindex="-1"><a class="header-anchor" href="#patchunkeyedchildren" aria-hidden="true">#</a> patchUnkeyedChildren</h5><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">patchUnkeyedChildren</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c1</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">[]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c2</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNodeArrayChildren</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    container</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererElement</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    anchor</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">RendererNode</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentComponent</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">ComponentInternalInstance</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    parentSuspense</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">SuspenseBoundary</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    isSVG</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    slotScopeIds</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">string</span><span style="color:var(--shiki-color-text);">[] </span><span style="color:var(--shiki-token-keyword);">|</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    optimized</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">boolean</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  ) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c1 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c1 </span><span style="color:var(--shiki-token-keyword);">||</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">EMPTY_ARR</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    c2 </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> c2 </span><span style="color:var(--shiki-token-keyword);">||</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">EMPTY_ARR</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">oldLength</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c1</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// æ–° vnodes çš„é•¿åº¦</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">newLength</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">c2</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// æ—§ vnodes çš„é•¿åº¦</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// è·å–æœ€å°çš„é‚£ä¸ª vnodes çš„é•¿åº¦ï¼Œç”¨æœ€å°é•¿åº¦çš„ vnodes éå†(ç”¨æœ€å¤§çš„å¯èƒ½äº§ç”Ÿè¶Šç•Œï¼Œç”¨é•¿åº¦æœ€å°çš„ vnodes å¯¹æ¯”)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">commonLength</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">Math</span><span style="color:var(--shiki-token-function);">.min</span><span style="color:var(--shiki-color-text);">(oldLength</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> newLength)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">let</span><span style="color:var(--shiki-color-text);"> i</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// ä¾æ¬¡ patch æ¯”è¾ƒ</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">for</span><span style="color:var(--shiki-color-text);"> (i </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">0</span><span style="color:var(--shiki-color-text);">; i </span><span style="color:var(--shiki-token-keyword);">&lt;</span><span style="color:var(--shiki-color-text);"> commonLength; i</span><span style="color:var(--shiki-token-keyword);">++</span><span style="color:var(--shiki-color-text);">) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">nextChild</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (c2[i] </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">?</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">cloneIfMounted</span><span style="color:var(--shiki-color-text);">(c2[i] </span><span style="color:var(--shiki-token-keyword);">as</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">VNode</span><span style="color:var(--shiki-color-text);">)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">normalizeVNode</span><span style="color:var(--shiki-color-text);">(c2[i]))</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">patch</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        c1[i]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        nextChild</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        optimized</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// æ—§çš„é•¿åº¦å¤§äºæ–°çš„ï¼Œè¿›è¡Œåˆ‡å°¾ï¼Œåˆ é™¤å¤šå‡ºæ¥çš„é•¿åº¦çš„å…ƒç´ </span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (oldLength </span><span style="color:var(--shiki-token-keyword);">&gt;</span><span style="color:var(--shiki-color-text);"> newLength) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// remove old</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">unmountChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        c1</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-constant);">false</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        commonLength</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    } </span><span style="color:var(--shiki-token-keyword);">else</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// æ—§çš„é•¿åº¦å°äºæ–°çš„ï¼Œåˆ›å»ºæ–°çš„å¤šå‡ºæ¥çš„èŠ‚ç‚¹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-comment);">// mount new</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      </span><span style="color:var(--shiki-token-function);">mountChildren</span><span style="color:var(--shiki-color-text);">(</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        c2</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-comment);">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        container</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        anchor</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentComponent</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        parentSuspense</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        isSVG</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        slotScopeIds</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        optimized</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        commonLength</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">      )</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">  }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/11/8 14:32:31</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: liyufeng@gz-yibo.com">æé›¨é”‹</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/docs/docs/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html" class="nav-link prev" aria-label="ğŸ› ï¸ å¼€å‘è§„èŒƒ"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->ğŸ› ï¸ å¼€å‘è§„èŒƒ</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/docs/assets/app.4ddfd4cd.js" defer></script>
  </body>
</html>
