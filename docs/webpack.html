<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://kiyan-a.github.io/sev/docs/docs/webpack.html"><meta property="og:site_name" content="K"><meta property="og:title" content="🛠️ Webpack"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-08T14:32:31.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-11-08T14:32:31.000Z"><link rel="icon" type="svg" href="/logo.svg"><title>🛠️ Webpack | K</title><meta name="description" content="记录成长,相信过程...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/docs/assets/style.0d78e735.css">
    <link rel="modulepreload" href="/docs/assets/app.4ddfd4cd.js"><link rel="modulepreload" href="/docs/assets/webpack.html.cbf125ad.js"><link rel="modulepreload" href="/docs/assets/webpack.html.f45c918a.js"><link rel="prefetch" href="/docs/assets/index.html.f5dd38ac.js"><link rel="prefetch" href="/docs/assets/exhibition.html.c7a89bd0.js"><link rel="prefetch" href="/docs/assets/article1.html.b6f368df.js"><link rel="prefetch" href="/docs/assets/article2.html.dfa3f786.js"><link rel="prefetch" href="/docs/assets/Axios封装.html.0d4a89d1.js"><link rel="prefetch" href="/docs/assets/ES6.html.e471b51d.js"><link rel="prefetch" href="/docs/assets/about.html.4f7c1c10.js"><link rel="prefetch" href="/docs/assets/accuracyProblem.html.663f4a84.js"><link rel="prefetch" href="/docs/assets/dev.html.528e106e.js"><link rel="prefetch" href="/docs/assets/disable.html.9b3a36e1.js"><link rel="prefetch" href="/docs/assets/for Js.html.2ccd5b0c.js"><link rel="prefetch" href="/docs/assets/markdown.html.c1569dc6.js"><link rel="prefetch" href="/docs/assets/mate.html.72ae4231.js"><link rel="prefetch" href="/docs/assets/nest.html.9d980397.js"><link rel="prefetch" href="/docs/assets/new Linux.html.f80b0124.js"><link rel="prefetch" href="/docs/assets/uni-app.html.ff3a7e0b.js"><link rel="prefetch" href="/docs/assets/vite.html.8c6355e5.js"><link rel="prefetch" href="/docs/assets/vue-details 源码.html.b752ae5f.js"><link rel="prefetch" href="/docs/assets/vue3.html.772fa207.js"><link rel="prefetch" href="/docs/assets/开发规范.html.aeb36f22.js"><link rel="prefetch" href="/docs/assets/文件资源处理.html.9dfa65ef.js"><link rel="prefetch" href="/docs/assets/index.html.9bd4fde8.js"><link rel="prefetch" href="/docs/assets/index.html.16ef35e4.js"><link rel="prefetch" href="/docs/assets/disable.html.4262b987.js"><link rel="prefetch" href="/docs/assets/encrypt.html.9cb1df49.js"><link rel="prefetch" href="/docs/assets/markdown.html.d9f34491.js"><link rel="prefetch" href="/docs/assets/page.html.bc7733b7.js"><link rel="prefetch" href="/docs/assets/404.html.67a54621.js"><link rel="prefetch" href="/docs/assets/index.html.6bb212ad.js"><link rel="prefetch" href="/docs/assets/index.html.933b48b1.js"><link rel="prefetch" href="/docs/assets/index.html.f325fe48.js"><link rel="prefetch" href="/docs/assets/index.html.e79b2fec.js"><link rel="prefetch" href="/docs/assets/index.html.6b0490c9.js"><link rel="prefetch" href="/docs/assets/index.html.273f2371.js"><link rel="prefetch" href="/docs/assets/index.html.b73cffd4.js"><link rel="prefetch" href="/docs/assets/index.html.0bc2113b.js"><link rel="prefetch" href="/docs/assets/index.html.1c609236.js"><link rel="prefetch" href="/docs/assets/index.html.ca6e47e4.js"><link rel="prefetch" href="/docs/assets/index.html.92e0a1cf.js"><link rel="prefetch" href="/docs/assets/index.html.2e28146c.js"><link rel="prefetch" href="/docs/assets/index.html.3c81acc3.js"><link rel="prefetch" href="/docs/assets/index.html.f592b8c2.js"><link rel="prefetch" href="/docs/assets/index.html.dcea69d7.js"><link rel="prefetch" href="/docs/assets/index.html.7c169c44.js"><link rel="prefetch" href="/docs/assets/index.html.64497277.js"><link rel="prefetch" href="/docs/assets/index.html.2cf1837f.js"><link rel="prefetch" href="/docs/assets/exhibition.html.92a863a1.js"><link rel="prefetch" href="/docs/assets/article1.html.8e9e72c2.js"><link rel="prefetch" href="/docs/assets/article2.html.e9ae525a.js"><link rel="prefetch" href="/docs/assets/Axios封装.html.2097d37c.js"><link rel="prefetch" href="/docs/assets/ES6.html.17ed64fb.js"><link rel="prefetch" href="/docs/assets/about.html.d04ff1c4.js"><link rel="prefetch" href="/docs/assets/accuracyProblem.html.b966a765.js"><link rel="prefetch" href="/docs/assets/dev.html.aef6b112.js"><link rel="prefetch" href="/docs/assets/disable.html.a30ff643.js"><link rel="prefetch" href="/docs/assets/for Js.html.727aa995.js"><link rel="prefetch" href="/docs/assets/markdown.html.f2b9db12.js"><link rel="prefetch" href="/docs/assets/mate.html.ed649eed.js"><link rel="prefetch" href="/docs/assets/nest.html.061a8959.js"><link rel="prefetch" href="/docs/assets/new Linux.html.cea3ca1d.js"><link rel="prefetch" href="/docs/assets/uni-app.html.d3c7e450.js"><link rel="prefetch" href="/docs/assets/vite.html.e7565562.js"><link rel="prefetch" href="/docs/assets/vue-details 源码.html.8ccd6020.js"><link rel="prefetch" href="/docs/assets/vue3.html.2ab4f6e7.js"><link rel="prefetch" href="/docs/assets/开发规范.html.3383673d.js"><link rel="prefetch" href="/docs/assets/文件资源处理.html.5f4bf217.js"><link rel="prefetch" href="/docs/assets/index.html.ba6f4fe4.js"><link rel="prefetch" href="/docs/assets/index.html.760cda5f.js"><link rel="prefetch" href="/docs/assets/disable.html.9a2e30a2.js"><link rel="prefetch" href="/docs/assets/encrypt.html.1f225bac.js"><link rel="prefetch" href="/docs/assets/markdown.html.e1043843.js"><link rel="prefetch" href="/docs/assets/page.html.b9c69c16.js"><link rel="prefetch" href="/docs/assets/404.html.c4517191.js"><link rel="prefetch" href="/docs/assets/index.html.6a313bda.js"><link rel="prefetch" href="/docs/assets/index.html.6f016ddd.js"><link rel="prefetch" href="/docs/assets/index.html.cafa9d38.js"><link rel="prefetch" href="/docs/assets/index.html.27652804.js"><link rel="prefetch" href="/docs/assets/index.html.53d408f3.js"><link rel="prefetch" href="/docs/assets/index.html.0557a2aa.js"><link rel="prefetch" href="/docs/assets/index.html.f60d8894.js"><link rel="prefetch" href="/docs/assets/index.html.4ee8e38c.js"><link rel="prefetch" href="/docs/assets/index.html.01b0303d.js"><link rel="prefetch" href="/docs/assets/index.html.74f8235e.js"><link rel="prefetch" href="/docs/assets/index.html.585712a1.js"><link rel="prefetch" href="/docs/assets/index.html.6853050a.js"><link rel="prefetch" href="/docs/assets/index.html.b9445087.js"><link rel="prefetch" href="/docs/assets/index.html.5a4cdc76.js"><link rel="prefetch" href="/docs/assets/index.html.7c5a19a6.js"><link rel="prefetch" href="/docs/assets/index.html.e92b39aa.js"><link rel="prefetch" href="/docs/assets/index.html.e784167c.js"><link rel="prefetch" href="/docs/assets/404.d0fb624d.js"><link rel="prefetch" href="/docs/assets/Layout.4c5fb240.js"><link rel="prefetch" href="/docs/assets/Slide.86c9d9fb.js"><link rel="prefetch" href="/docs/assets/Blog.8ef26a60.js"><link rel="prefetch" href="/docs/assets/auto.esm.36809f22.js"><link rel="prefetch" href="/docs/assets/index.daae04bf.js"><link rel="prefetch" href="/docs/assets/index.1842ee54.js"><link rel="prefetch" href="/docs/assets/mermaid.esm.min.d8b76e20.js"><link rel="prefetch" href="/docs/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/docs/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/docs/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/docs/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/docs/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/docs/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/docs/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/docs/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/docs/" class="brand"><img class="logo" src="/docs/logo.svg" alt="K"><!----><span class="site-name hide-in-pad">K</span></a><!----></div><div class="navbar-center"><!----><!----><!----></div><div class="navbar-right"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/docs/docs/about.html" class="nav-link" aria-label="🎉文档"><!---->🎉文档<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="🪂组件"><span class="title"><!---->🪂组件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/components/article1.html" class="nav-link" aria-label="文章 1"><span class="icon iconfont icon-edit" style=""></span>文章 1<!----></a></li><li class="dropdown-item"><a href="/docs/components/article2.html" class="nav-link" aria-label="文章 2"><span class="icon iconfont icon-edit" style=""></span>文章 2<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/docs/log/" class="nav-link" aria-label="🪵更新日志"><!---->🪵更新日志<!----></a></div></nav><!----><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><div class="nav-item"><a class="repo-link" href="https://github.com/Kiyan-a" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><a href="/docs/docs/" class="title">🎉文档</a><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/docs/docs/disable.html" class="nav-link sidebar-link sidebar-page" aria-label="布局与功能禁用"><span class="icon iconfont icon-config" style=""></span>布局与功能禁用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown 展示"><span class="icon iconfont icon-markdown" style=""></span>Markdown 展示<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/for%20Js.html" class="nav-link sidebar-link sidebar-page" aria-label="✍️ JS 技巧"><!---->✍️ JS 技巧<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/accuracyProblem.html" class="nav-link sidebar-link sidebar-page" aria-label="✍️ JS 精度问题"><!---->✍️ JS 精度问题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86.html" class="nav-link sidebar-link sidebar-page" aria-label="✍️ 文件资源处理"><!---->✍️ 文件资源处理<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/mate.html" class="nav-link sidebar-link sidebar-page" aria-label="👑 新的 Vue 项目"><!---->👑 新的 Vue 项目<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/ES6.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 ES6"><!---->📖 ES6<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/nest.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 NestJs"><!---->📖 NestJs<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/new%20Linux.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 Nginx"><!---->📖 Nginx<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/uni-app.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 uni-app"><!---->📖 uni-app<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/vite.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 Vite 基本使用"><!---->📖 Vite 基本使用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/vue3.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 Vue 3"><!---->📖 Vue 3<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/Axios%E5%B0%81%E8%A3%85.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 基于 typescript 二次封装 axios"><!---->📖 基于 typescript 二次封装 axios<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/dev.html" class="nav-link sidebar-link sidebar-page" aria-label="📖 调试技巧"><!---->📖 调试技巧<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/about.html" class="nav-link sidebar-link sidebar-page" aria-label="🦚 关于"><!---->🦚 关于<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/docs/webpack.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="🛠️ Webpack"><!---->🛠️ Webpack<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/webpack.html#基础细节" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="基础细节"><!---->基础细节<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/webpack.html#区分环境" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="区分环境"><!---->区分环境<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/webpack.html#自定义插件-plugin" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="自定义插件 Plugin"><!---->自定义插件 Plugin<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/docs/webpack.html#自定义-loader" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="自定义 loader"><!---->自定义 loader<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/docs/docs/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html" class="nav-link sidebar-link sidebar-page" aria-label="🛠️ 开发规范"><!---->🛠️ 开发规范<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/docs/vue-details%20%E6%BA%90%E7%A0%81.html" class="nav-link sidebar-link sidebar-page" aria-label="Vue"><!---->Vue<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">🪂组件</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><a href="/docs/exhibition.html" class="nav-link sidebar-link sidebar-page" aria-label="幻灯片"><!---->幻灯片<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->🛠️ Webpack</h1><!----><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/webpack.html#基础细节" class="router-link-active router-link-exact-active toc-link level3">基础细节</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/webpack.html#区分环境" class="router-link-active router-link-exact-active toc-link level3">区分环境</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/webpack.html#自定义插件-plugin" class="router-link-active router-link-exact-active toc-link level3">自定义插件 Plugin</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/docs/webpack.html#自定义-loader" class="router-link-active router-link-exact-active toc-link level3">自定义 loader</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="🛠️-webpack" tabindex="-1"><a class="header-anchor" href="#🛠️-webpack" aria-hidden="true">#</a> 🛠️ Webpack</h1><h3 id="基础细节" tabindex="-1"><a class="header-anchor" href="#基础细节" aria-hidden="true">#</a> 基础细节</h3><blockquote><p>🌅 默认的配置文件名称是 webpack.config,js 🏜️ webpack.config.js 是以 Common JS 规范进行组织的 🌄 使用 Webpack 的过程，大部分就是跟配置文件打交道的过程</p></blockquote><blockquote><p>注意整个配置中我们使用 Node 内置的 path 模块，并在它前面加上 <a href="https://nodejs.org/docs/latest/api/globals.html#globals_dirname" target="_blank" rel="noopener noreferrer">__dirname<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>这个全局变量。<strong>可以防止不同操作系统之间的文件路径问题</strong>，并且可以使相对路径按照预期工作。</p><p>__dirname：当前文件绝对路径</p><p>join 与 resolve 区别：</p><p>🪂 <code>path.join(&#39;/a&#39;, &#39;/b&#39;); 输出：/a/b</code></p><p>​ <code>path.resolve(&#39;/a&#39;, &#39;/b&#39;); 输出： /b</code></p><p>⛵ <strong>join 是把各个 path 片段连接在一起， resolve 把‘／’当成根目录</strong></p><p>🍟 resolve 在传入非/路径时，会自动<code>加上当前目录</code>形成一个绝对路径，而 join <code>仅仅用于路径拼接</code></p><p>🛵 join 与 resolve 的操作类似于 cd 命令</p></blockquote><blockquote><p>module (模块配置，不同类型文件的配置 <code>loader 配置</code>)</p></blockquote><blockquote><p>指定规则配置有三种方式，按照加载先后顺序，依次是： 🛰️ 在 package.json 中的 stylelint 属性指定规则 🚀 在 .stylelintrc 中指定规则 🏹 在 stylelint.config.js 中指定规则</p></blockquote><blockquote><p>配置 webpack develop server 后，默认会将打包的内容保存到内存当中(提高打包读写数据效率)</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-constant);">module</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">exports</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-comment);">//...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	devServer</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		client</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			progress</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// 在浏览器中以百分比显示编译进度</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			reconnect</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">true</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// 尝试重新连接客户端的次数。为 true 时，将无限次尝试重新连接。</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		}</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		webSocketServer</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;ws&#39;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// &#39;ws&#39; | &#39;sockjs&#39; 为客户端单独选择当前的 devServer 传输模式，或者提供自定义的客户端实现。这允许指定浏览器或其他客户端与 devServer 的通信方式。</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	}</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="区分环境" tabindex="-1"><a class="header-anchor" href="#区分环境" aria-hidden="true">#</a> 区分环境</h3><h6 id="通过环境变量区分" tabindex="-1"><a class="header-anchor" href="#通过环境变量区分" aria-hidden="true">#</a> 通过环境变量区分</h6><blockquote><p>通过命令行读取环境变量 <code>webpack--env.production</code>，通过环境变量区分不同的打包环境</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-constant);">webpack</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">config</span><span style="color:var(--shiki-color-text);">.js</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">函数式写法</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">module</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">exports</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> (env</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);">argv) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">//开发</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">config</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">mode:</span><span style="color:var(--shiki-token-string-expression);">&#39;development&#39;</span><span style="color:var(--shiki-color-text);">.</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// 生产</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (</span><span style="color:var(--shiki-token-constant);">env</span><span style="color:var(--shiki-color-text);">.production){</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">config</span><span style="color:var(--shiki-color-text);">.mode </span><span style="color:var(--shiki-token-string-expression);">&#39;production&#39;</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// 更多配置...</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> config</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h6 id="通过配置文件区分" tabindex="-1"><a class="header-anchor" href="#通过配置文件区分" aria-hidden="true">#</a> 通过配置文件区分</h6><blockquote><p><strong><code>webpack.dev.conf.js、webpack.prod.conf.js</code></strong> 命令执行打包时，指定配置文件 ( <code>webpack-config webpack.[dev|prod).conf.js</code> )</p></blockquote><h6 id="抽取公共配置对不同环境的配置进行合并" tabindex="-1"><a class="header-anchor" href="#抽取公共配置对不同环境的配置进行合并" aria-hidden="true">#</a> 抽取公共配置对不同环境的配置进行合并</h6><blockquote><p>声明公共的配置文件，如 <code>webpack.base.conf.js</code>，通过 <code>webpack-merge</code>包，将多个配置合并；</p><p><code>webpack.prod.conf.js + webpack.base.conf.js</code></p><p><code>webpack.dev.conf.js + webpack.base.conf.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">merge</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;webpack-merge&#39;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">baseWebpackConfig</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;./webpack.base.conf&#39;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">devWebpackConfig</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">merge</span><span style="color:var(--shiki-color-text);">(baseWebpackConfig</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-comment);">// ...开发环境配置</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-constant);">module</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">exports</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> devWebpackConfig;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h6 id="通过-defineplugin-创建-注入-全局变量" tabindex="-1"><a class="header-anchor" href="#通过-defineplugin-创建-注入-全局变量" aria-hidden="true">#</a> 通过 DefinePlugin 创建(注入)全局变量</h6><blockquote><p><strong><code>Webpack DefinePlugin</code></strong></p><p>DefinePlugin</p><p>🧫 为配置注入全局变量</p><p>🛹 开发环境和生产环境的接口地址不同</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">webpack</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;webpack&#39;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// webpack.config.js</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">module</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">exports</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-comment);">// ...</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	plugins</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> [</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		</span><span style="color:var(--shiki-token-keyword);">new</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">webpack</span><span style="color:var(--shiki-token-function);">.Defineplugin</span><span style="color:var(--shiki-color-text);">({</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			</span><span style="color:var(--shiki-token-comment);">// 变量值(value)要求是一个代码片段,直接赋值字符串类型时，打包后并不是一个字符		串类型的值，需要通过`JSON.stringify`转化⛵</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">			API_BASE_URL</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">JSON</span><span style="color:var(--shiki-token-function);">.stringify</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;https://api.example.com&#39;</span><span style="color:var(--shiki-color-text);">)</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		})</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	]</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// 在项目代码中</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">console</span><span style="color:var(--shiki-token-function);">.log</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">API_BASE_URL</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="自定义插件-plugin" tabindex="-1"><a class="header-anchor" href="#自定义插件-plugin" aria-hidden="true">#</a> 自定义插件 Plugin</h3><blockquote><p>当现有的插件满足不了实际开发的需求时候，需要自定义 Plugin</p><p>**<code>Webpack 插件是一个具有 appy 方法的 JavaScript 对象</code>**apply 方法会被 webpack compiler 调用，<strong>并且在整个编译生命周期都可以访问 compiler 对象。</strong></p><p><strong>原理</strong> 通过在生命周期的钩子中挂载函数，来实现功能扩展</p><p>​ <strong>钩子</strong></p><p>​ 钩子是<strong>提前在可能增加功能的地方，埋好(预设)一个函数</strong></p></blockquote><blockquote><p><strong>常用钩子(总共有 50 个左右钩子)</strong></p><p><img src="/docs/img/webpack.png" alt="" loading="lazy"></p></blockquote><blockquote><p>注意：emit 是修改内容的最后机会(输出之前)⛵</p><p>示例代码：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// 自定义定义插件</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">class</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">Plugin</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-keyword);">constructor</span><span style="color:var(--shiki-color-text);">(options){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// 插件插入的配置选项</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		console</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-token-function);">log</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;插件选项：&#39;</span><span style="color:var(--shiki-color-text);">，options)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 必须要有apply方法</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-function);">apply</span><span style="color:var(--shiki-color-text);">(compiler）{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        </span><span style="color:var(--shiki-token-comment);">// 选择调用的钩子(如 emit)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    	compiler.hooks.emit.tap(&#39;插件名称&#39;，(compilation)</span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	</span><span style="color:var(--shiki-token-comment);">// 通过 compilation(此次打包的上下文)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	console.Log(</span><span style="color:var(--shiki-token-string-expression);">&#39;webpack构建过程开始！&#39;</span><span style="color:var(--shiki-color-text);">，compilation);</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	</span><span style="color:var(--shiki-token-comment);">// 通过 compilation.assets[文件名].source() 获取文件内容</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	</span><span style="color:var(--shiki-token-comment);">// 通过正则等方式修改内容</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	</span><span style="color:var(--shiki-token-comment);">// 将替换完成后的内容归原位</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        	compilation.assets[文件名]={</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                source</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> () </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> 替换后内容</span><span style="color:var(--shiki-token-punctuation);">,</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">                size</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">替换后内容</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">length</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">            }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">        })</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    }</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p><code>endsWith()</code> <strong>判断字符串后面是否以参数是相同的结尾</strong></p><h3 id="自定义-loader" tabindex="-1"><a class="header-anchor" href="#自定义-loader" aria-hidden="true">#</a> 自定义 loader</h3><blockquote><p>loader <strong><code>本质上就是一个 ESModel 模块(一个函数)</code></strong>，它导出一个函数，在**<code>函数中对打包资源进行转化</code>**</p><p>🛹 webpack 调用 loader 的时机在触发 compilation 的 buildModule 钩子之后</p><p>🛹 它的核心步骤是从文件原始内容中取得序列化的字符串，修复 JSON 序列化特殊字符时的 bug，添加导出语句，使其成为 JavaScript 模块</p><p>注意：<strong><code>在转化过程当中，要求最终转化(最后一个 loader)的必须为 JavaScript 代码字符串，否则报错</code></strong> &#39;consloe.log(&quot;YYYYY&quot;)&#39;、<code>&#39;model.export=${JSON.stringify(html)}&#39;</code></p><p>使用 <code>JSON.stringify()</code>原因是输出内容可能存在字符串引号相同导致的 bug 错误，JavaScript 代码中字符串引号包裹问题 &quot; &quot;&quot; &quot; ❌ &quot; &#39;&#39; &quot;💯</p></blockquote><blockquote><p>ES Modules 是 2015 年推出的，语言层面的模块化规范，与运行环境无关，服务器和浏览器中都能使用。</p><p>在 html 中，<strong><code>通过给 script 添加 type = module 的属性，就可以用 ES Module 的标准执行其中的 JS 代码</code></strong></p><p>每个 ES Module 都是运行在单独的私有作用域中，不会有全局作用域污染的问题。</p></blockquote><blockquote><p>🛵 <code>loader-utils</code> 与 <code>schema-utils</code>，可以使获取及验证传递给 loader 的参数配置项的工作简单化</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">getoptions</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;loader-utils&#39;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> { </span><span style="color:var(--shiki-token-constant);">validate</span><span style="color:var(--shiki-color-text);"> } </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&quot;schema-utils&quot;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">marked</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">require</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-string-expression);">&#39;marked&#39;</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// 自定义loader，source：要处理的内容</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">module</span><span style="color:var(--shiki-color-text);">.</span><span style="color:var(--shiki-token-constant);">exports</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);">(source){</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 获取loader配置选项🪂 注意 loader 函数不能写成【箭头函数(this 指向问题)】</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">options</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">getoptions</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-color-text);">);</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 对输入内容进行处理🏹</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">html</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">marked</span><span style="color:var(--shiki-color-text);">(source)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">//  通过 this.callback 可以返回除内容以外的其他信息(如 sourcemap)</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-comment);">// 【返还始下一个 loader 处理】🏜️ 转换内容后，可以通过 return 或调用 this.callback 返回结果</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> html</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--shiki-color-text);">使用：</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">{</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    test</span><span style="color:var(--shiki-token-punctuation);">:</span><span style="color:var(--shiki-token-string-expression);">/\.md</span><span style="color:var(--shiki-token-keyword);">$</span><span style="color:var(--shiki-token-string-expression);">/</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-comment);">// 匹配</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">    use</span><span style="color:var(--shiki-token-punctuation);">:</span><span style="color:var(--shiki-token-string-expression);">&#39;loader 名称 || 忘记文件路径&#39;</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong><code>通过 this.async 可以获取异步操作的回调函数，并在回调函数中返回结果</code></strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">export</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">default</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">function</span><span style="color:var(--shiki-color-text);"> (content</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> map</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> meta) {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">callback</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-token-function);">.async</span><span style="color:var(--shiki-color-text);">();</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	</span><span style="color:var(--shiki-token-function);">someAsyncOperation</span><span style="color:var(--shiki-color-text);">(content</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> (err</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> result</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> sourceMaps</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> meta) </span><span style="color:var(--shiki-token-keyword);">=&gt;</span><span style="color:var(--shiki-color-text);"> {</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		</span><span style="color:var(--shiki-token-keyword);">if</span><span style="color:var(--shiki-color-text);"> (err) </span><span style="color:var(--shiki-token-keyword);">return</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-function);">callback</span><span style="color:var(--shiki-color-text);">(err);</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">		</span><span style="color:var(--shiki-token-function);">callback</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">null</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> result</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> sourceMaps</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> meta);</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">	});</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除非计算很小，否则对于 Node.js 这种单线程环境，尽可能使用异步 loader。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// 因为 babel 的 preset-env 会将 ES6 module 转化为 Common.js 的形式，会导致 webpack 中 tree-shaking 特性失效，所有将 modules 置为 false,交给webpack 自身处理</span></span>
<span class="line"><span style="color:var(--shiki-color-text);">modules</span><span style="color:var(--shiki-token-punctuation);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">false</span><span style="color:var(--shiki-color-text);">; </span><span style="color:var(--shiki-token-comment);">// 通常会在配置 loader 将 modules 置为 false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>loader-utils 主要有以下工具方法：</p><ul><li><p><code>parseQuery</code>：解析 loader 的 query 参数，返回一个对象。</p></li><li><p><code>stringifyRequest</code>：将请求的资源转换为可以在 loader 生成的代码中 require 或 import 使用的相对路径字符串，同时避免绝对路径导致重新计算 hash 值</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-constant);">loaderUtils</span><span style="color:var(--shiki-token-function);">.stringifyRequest</span><span style="color:var(--shiki-color-text);">(</span><span style="color:var(--shiki-token-constant);">this</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;./test.js&#39;</span><span style="color:var(--shiki-color-text);">); </span><span style="color:var(--shiki-token-comment);">// &quot;\&quot;./test.js\&quot;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p><code>urlToRequest</code>：将请求的资源路径转换成 webpack 可以处理的形式</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">url</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&#39;~path/to/module.js&#39;</span><span style="color:var(--shiki-color-text);">;</span></span>
<span class="line"><span style="color:var(--shiki-token-keyword);">const</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">request</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">=</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-constant);">loaderUtils</span><span style="color:var(--shiki-token-function);">.urlToRequest</span><span style="color:var(--shiki-color-text);">(url); </span><span style="color:var(--shiki-token-comment);">// &quot;path/to/module.js&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>interpolateName</code>：对文件名模板进行插值。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:var(--shiki-color-background);"><code><span class="line"><span style="color:var(--shiki-token-comment);">// loaderContext.resourcePath = &quot;/absolute/path/to/app/js/hzfe.js&quot;</span></span>
<span class="line"><span style="color:var(--shiki-token-constant);">loaderUtils</span><span style="color:var(--shiki-token-function);">.interpolateName</span><span style="color:var(--shiki-color-text);">(loaderContext</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-string-expression);">&quot;js/[hash].script.[ext]&quot;</span><span style="color:var(--shiki-token-punctuation);">,</span><span style="color:var(--shiki-color-text);"> { content</span><span style="color:var(--shiki-token-keyword);">:</span><span style="color:var(--shiki-color-text);"> </span><span style="color:var(--shiki-token-keyword);">...</span><span style="color:var(--shiki-color-text);"> });</span></span>
<span class="line"><span style="color:var(--shiki-token-comment);">// =&gt; js/9473fdd0d880a43c21b7778d34872157.script.js</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>getHashDigest</code>：获取文件内容的 hash 值。</p></li><li></li></ul><p>在编写 loader 的过程中，还可以利用 loaderContext 对象来获取 loader 的相关信息和进行一些高级的操作，常见的属性和方法有：</p><ul><li><code>this.addDependency</code>：加入一个文件，作为 loader 产生的结果的依赖，使其在有任何变化时可以被监听到，从而触发重新编译</li><li><code>this.async</code>：告诉 loader-runner 这个 loader 将会异步的执行回调</li><li><code>this.cacheable</code>：默认情况下，将 loader 的处理结果标记为可缓存。传入 false 可以关闭 loader 处理结果的缓存能力</li><li><code>this.fs</code>：用于访问 compilation 的 inputFileSystem 属性</li><li><code>this.getOptions</code>：提取 loader 的配置选项。从 webpack 5 开始，可以获取到 loader 上下文对象，用于替代 <code>loader-utils</code> 中的 getOptions 方法</li><li><code>this.mode</code>： webpack 的运行模式，可以是 “development” 或 “production”</li><li><code>this.query</code>：如果 loader 配置了 options 对象，则指向这个对象。如果 loader 没有 options，而是以 query 字符串作为参数，query 则是一个以 <code>?</code> 开头的字符串</li></ul></blockquote></div><!----><footer class="page-meta"><!----><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/11/8 14:32:31</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: liyufeng@gz-yibo.com">李雨锋</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/docs/docs/about.html" class="nav-link prev" aria-label="🦚 关于"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->🦚 关于</div></a><a href="/docs/docs/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html" class="nav-link next" aria-label="🛠️ 开发规范"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">🛠️ 开发规范<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/docs/assets/app.4ddfd4cd.js" defer></script>
  </body>
</html>
